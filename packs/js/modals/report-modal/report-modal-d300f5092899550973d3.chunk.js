"use strict";(self.webpackChunkmangane_fe=self.webpackChunkmangane_fe||[]).push([[209],{812:function(e,t,r){r.r(t),r.d(t,{default:function(){return G}});var a,o=r(1845),s=(r(2),r(0)),n=r(879),i=r(1834),d=r(1857),u=r(13),c=r(100),l=r(25),f=r(176),g=r(137),p=r(1),m=r(23),h=r(3),v=r(99),b=(0,n.vU)({title:{id:"report.confirmation.title",defaultMessage:"Thanks for submitting your report."},content:{id:"report.confirmation.content",defaultMessage:"If we find that this account is violating the {link} we will take further action on the matter."}}),Z=(0,o.Z)(d.Z,{id:"shared.tos",defaultMessage:"Terms of Service"}),k=r(339),x=r(6),w=r(166),M=r(374),C=(r(7),function(e){var t=e.id,r=e.disabled,a=(0,h.TL)(),s=(0,h.CG)((function(e){return e.statuses.get(t)})),n=(0,h.CG)((function(e){return e.reports.new.status_ids.includes(t)}));return!s||s.reblog?null:(0,o.Z)("label",{className:"flex gap-2 items-start select-none bg-gray-100 dark:bg-slate-600 rounded-lg p-2"},void 0,(0,o.Z)("div",{className:"status-check-box-toggle"},void 0,(0,o.Z)(p.XZ,{checked:n,onChange:function(e){return a((0,c.cm)(t,e.target.checked))},disabled:r})),(0,o.Z)("div",{className:"status-check-box__status"},void 0,(0,o.Z)(g.Z,{status:s})))}),y=r(46),E=(0,n.vU)({addAdditionalStatuses:{id:"report.otherActions.addAdditionl",defaultMessage:"Would you like to add additional statuses to this report?"},addMore:{id:"report.otherActions.addMore",defaultMessage:"Add more"},furtherActions:{id:"report.otherActions.furtherActions",defaultMessage:"Further actions:"},hideAdditonalStatuses:{id:"report.otherActions.hideAdditional",defaultMessage:"Hide additional statuses"},otherStatuses:{id:"report.otherActions.otherStatuses",defaultMessage:"Include other statuses?"}}),T=r(5),_=r.n(T),N=(0,n.vU)({placeholder:{id:"report.placeholder",defaultMessage:"Additional comments"},placeholderDescription:{id:"report.placeholder-description",defaultMessage:"Please explain the reason of your report"},reasonForReporting:{id:"report.reason.title",defaultMessage:"Reason for reporting"}}),S=(0,n.vU)({blankslate:{id:"report.reason.blankslate",defaultMessage:"You have removed all statuses from being selected."},done:{id:"report.done",defaultMessage:"Done"},next:{id:"report.next",defaultMessage:"Next"},close:{id:"lightbox.close",defaultMessage:"Close"},placeholder:{id:"report.placeholder",defaultMessage:"Additional comments"},submit:{id:"report.submit",defaultMessage:"Submit"}});!function(e){e.ONE="ONE",e.TWO="TWO",e.THREE="THREE"}(a||(a={}));var z={ONE:function(e){var t=(0,x.I0)(),r=(0,i.Z)(),a=(0,s.useRef)(null),n=(0,s.useState)(!1),d=n[0],u=n[1],l=(0,s.useState)(!0),f=l[0],g=l[1],m=(0,h.CG)((function(e){return e.reports.new.comment})),v=(0,h.CG)((function(e){return e.rules.items})),b=(0,h.CG)((function(e){return e.reports.new.rule_ids})),Z=v.length>0,k=(0,h.CG)((function(e){return e.reports.new.status_ids})),w=(0,s.useMemo)((function(){return 0===k.size}),[k.size]),C=(0,s.useCallback)((function(e){t((0,c.Ck)(e.target.value))}),[t]),y=(0,s.useCallback)((function(){if(a.current){var e=a.current,t=e.scrollTop,r=e.scrollHeight,o=e.clientHeight;u(t+o>r-24),g(t<24)}}),[]),E=(0,s.useCallback)((function(e){var t=w?"account":"content";return!e.rule_type||e.rule_type===t}),[w]);return(0,s.useEffect)((function(){t((0,M.j)())}),[t]),(0,s.useEffect)((function(){v.length>0&&a.current&&a.current.clientHeight<=385&&u(!0)}),[v]),(0,o.Z)(p.Kq,{space:4},void 0,Z&&(0,o.Z)(p.Kq,{space:2},void 0,(0,o.Z)(p.xv,{size:"xl",weight:"semibold",tag:"h1"},void 0,r.formatMessage(N.reasonForReporting)),(0,o.Z)("div",{className:"relative"},void 0,s.createElement("div",{style:{maxHeight:385},className:"rounded-lg -space-y-px overflow-y-auto",onScroll:y,ref:a},v.filter(E).map((function(e,r){var a=b.includes(String(e.id));return(0,o.Z)("button",{"data-testid":"rule-".concat(e.id),onClick:function(){return t((0,c.Nr)(e.id))},className:_()({"relative border border-solid border-gray-200 dark:border-slate-900/75 hover:bg-gray-50 dark:hover:bg-slate-900/50 text-left w-full p-4 flex justify-between items-center cursor-pointer":!0,"rounded-tl-lg rounded-tr-lg":0===r,"rounded-bl-lg rounded-br-lg":r===v.length-1,"bg-gray-50 dark:bg-slate-900":a})},r,(0,o.Z)(p.Kq,{className:"mr-3"},void 0,(0,o.Z)(p.xv,{tag:"span",size:"sm",weight:"medium",theme:a?"primary":"default"},void 0,e.text),(0,o.Z)(p.xv,{tag:"span",theme:"muted",size:"sm"},void 0,e.subtext)),(0,o.Z)("input",{name:"reason",type:"checkbox",value:e.id,checked:a,readOnly:!0,className:"h-4 w-4 cursor-pointer text-primary-600 dark:text-primary-400 border-gray-300 rounded focus:ring-primary-500"}))}))),(0,o.Z)("div",{className:_()("inset-x-0 top-0 flex rounded-t-lg justify-center bg-gradient-to-b from-white pb-12 pt-8 pointer-events-none dark:from-slate-900 absolute transition-opacity duration-500",{"opacity-0":f,"opacity-100":!f})}),(0,o.Z)("div",{className:_()("inset-x-0 bottom-0 flex rounded-b-lg justify-center bg-gradient-to-t from-white pt-12 pb-8 pointer-events-none dark:from-slate-900 absolute transition-opacity duration-500",{"opacity-0":d,"opacity-100":!d})}))),(0,o.Z)(p.cw,{labelText:r.formatMessage(N.placeholder)},void 0,(0,o.Z)(p.gx,{placeholder:r.formatMessage(N.placeholderDescription),value:m,onChange:C})))},TWO:function(e){var t=e.account,a=(0,x.I0)(),n=(0,h.hz)(),u=(0,i.Z)(),l=(0,h.CG)((function(e){return e.reports.new.status_ids})),f=(0,h.CG)((function(e){return(0,k.OrderedSet)(e.timelines.get("account:".concat(t.id,":with_replies")).items).union(e.reports.new.status_ids)})),g=(0,h.CG)((function(e){return e.reports.new.block})),m=(0,h.CG)((function(e){return e.reports.new.forward})),v=(0,y.Q1)(t)&&n.federating,b=(0,h.CG)((function(e){return e.reports.new.isSubmitting})),Z=(0,s.useState)(!1),T=Z[0],_=Z[1];return(0,s.useEffect)((function(){a((0,M.j)())}),[a]),(0,o.Z)(p.Kq,{space:4},void 0,n.reportMultipleStatuses&&(0,o.Z)(p.Kq,{space:2},void 0,(0,o.Z)(p.xv,{tag:"h1",size:"xl",weight:"semibold"},void 0,u.formatMessage(E.otherStatuses)),(0,o.Z)(p.cw,{labelText:u.formatMessage(E.addAdditionalStatuses)},void 0,T?(0,o.Z)(p.Kq,{space:2},void 0,(0,o.Z)("div",{className:"flex flex-col gap-4"},void 0,f.map((function(e){return(0,o.Z)(C,{id:e,disabled:e===l.first()},e)}))),(0,o.Z)("div",{},void 0,(0,o.Z)(p.zx,{icon:r(930),theme:"secondary",size:"sm",onClick:function(){return _(!1)}},void 0,u.formatMessage(E.hideAdditonalStatuses)))):(0,o.Z)(p.zx,{icon:r(50),theme:"secondary",size:"sm",onClick:function(){return _(!0)}},void 0,u.formatMessage(E.addMore)))),(0,o.Z)(p.Kq,{space:2},void 0,(0,o.Z)(p.xv,{tag:"h1",size:"xl",weight:"semibold"},void 0,u.formatMessage(E.furtherActions)),(0,o.Z)(p.cw,{labelText:(0,o.Z)(d.Z,{id:"report.block_hint",defaultMessage:"Do you also want to block this account?"})},void 0,(0,o.Z)(p.Ug,{space:2,alignItems:"center"},void 0,(0,o.Z)(w.Z,{checked:g,onChange:function(e){a((0,c.LG)(e.target.checked))},icons:!1,id:"report-block"}),(0,o.Z)(p.xv,{theme:"muted",tag:"label",size:"sm",htmlFor:"report-block"},void 0,(0,o.Z)(d.Z,{id:"report.block",defaultMessage:"Block {target}",values:{target:"@".concat(t.get("acct"))}})))),v&&(0,o.Z)(p.cw,{labelText:(0,o.Z)(d.Z,{id:"report.forward_hint",defaultMessage:"The account is from another server. Send a copy of the report there as well?"})},void 0,(0,o.Z)(p.Ug,{space:2,alignItems:"center"},void 0,(0,o.Z)(w.Z,{checked:m,onChange:function(e){a((0,c.$p)(e.target.checked))},icons:!1,id:"report-forward",disabled:b}),(0,o.Z)(p.xv,{theme:"muted",tag:"label",size:"sm",htmlFor:"report-forward"},void 0,(0,o.Z)(d.Z,{id:"report.forward",defaultMessage:"Forward to {target}",values:{target:(0,y.ge)(t)}}))))))},THREE:function(e){e.account;var t,r=(0,i.Z)(),a=(0,h.CG)((function(e){return(0,v.UX)(e).get("links")}));return(0,o.Z)(p.Kq,{space:1},void 0,(0,o.Z)(p.xv,{weight:"semibold",tag:"h1",size:"xl"},void 0,r.formatMessage(b.title)),(0,o.Z)(p.xv,{},void 0,r.formatMessage(b.content,{link:a.get("termsOfService")?(t=a.get("termsOfService"),(0,o.Z)("a",{href:t,target:"_blank",className:"hover:underline text-primary-600 dark:text-primary-400 hover:text-primary-800 dark:hover:text-primary-500"},void 0,Z)):Z})))}},A=function(e){var t=e.statusId,r=(0,h.CG)((function(e){return e.statuses.get(t)}));return r?(0,o.Z)(p.Kq,{space:2,className:"p-4 rounded-lg bg-gray-100 dark:bg-slate-700"},void 0,(0,o.Z)(m.Z,{id:r.account,showProfileHoverCard:!1,withLinkToProfile:!1,timestamp:r.created_at,hideActions:!0}),(0,o.Z)(g.Z,{status:r,expanded:!0,collapsable:!0}),r.media_attachments.size>0&&(0,o.Z)(f.Z,{media:r.media_attachments,sensitive:r.sensitive})):null},G=function(e){var t=e.onClose,r=(0,h.TL)(),n=(0,i.Z)(),f=(0,h.CG)((function(e){return e.reports.new.account_id})),g=(0,h.mA)(f),m=(0,h.CG)((function(e){return e.reports.new.block})),v=(0,h.CG)((function(e){return e.reports.new.isSubmitting})),b=(0,h.CG)((function(e){return e.rules.items})),Z=(0,h.CG)((function(e){return e.reports.new.rule_ids})),k=(0,h.CG)((function(e){return e.reports.new.status_ids})),x=(0,s.useMemo)((function(){return 0===k.size}),[k.size]),w=b.length>0,M=(0,s.useState)(a.ONE),C=M[0],y=M[1],E=(0,s.useCallback)((function(){r((0,c.ZD)()).then((function(){return y(a.THREE)})).catch((function(e){return r((0,c.rC)(e))})),m&&g&&r((0,u.Gy_)(g.id))}),[g,r,m]),T=(0,s.useCallback)((function(){switch(C){case a.ONE:y(a.TWO);break;case a.TWO:E();break;case a.THREE:r((0,c.rq)()),t()}}),[C,r,E,t]),_=(0,s.useCallback)((function(){return 0===k.size?(0,o.Z)("div",{className:"bg-gray-100 dark:bg-slate-700 p-4 rounded-lg flex items-center justify-center w-full"},void 0,(0,o.Z)(p.xv,{theme:"muted"},void 0,n.formatMessage(S.blankslate))):(0,o.Z)(A,{statusId:k.first()})}),[n,k]),N=(0,s.useMemo)((function(){switch(C){case a.TWO:return n.formatMessage(S.submit);case a.THREE:return n.formatMessage(S.done);default:return n.formatMessage(S.next)}}),[C,n]),G=(0,s.useMemo)((function(){return C!==a.THREE&&(v||w&&Z.isEmpty()||!x&&0===k.size)}),[C,v,w,Z,k.size,x]),O=(0,s.useCallback)((function(){switch(C){case a.ONE:return.33;case a.TWO:return.66;case a.THREE:return 1;default:return 0}}),[C]);if((0,s.useEffect)((function(){g&&r((0,l.Cn)(g.id,{withReplies:!0,maxId:null}))}),[g,r]),!g)return null;var H=z[C];return(0,o.Z)(p.u_,{title:(0,o.Z)(d.Z,{id:"report.target",defaultMessage:"Reporting {target}",values:{target:(0,o.Z)("strong",{},void 0,"@",g.acct)}}),onClose:t,cancelAction:C===a.THREE?void 0:t,confirmationAction:T,confirmationText:N,confirmationDisabled:G,skipFocus:!0},void 0,(0,o.Z)(p.Kq,{space:4},void 0,(0,o.Z)(p.ko,{progress:O()}),C!==a.THREE&&!x&&_(),(0,o.Z)(H,{account:g})))}}}]);
//# sourceMappingURL=report-modal-d300f5092899550973d3.chunk.js.map