{"version":3,"file":"packs/js/features/hashtag_timeline-cef405be429e217d2c9e.chunk.js","mappings":"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","sources":["webpack://mangane-fe/./node_modules/lodash/isEqual.js","webpack://mangane-fe/./app/soapbox/components/column_header.js","webpack://mangane-fe/./app/soapbox/features/hashtag_timeline/index.tsx"],"sourcesContent":["var baseIsEqual = require('./_baseIsEqual');\n/**\n * Performs a deep comparison between two values to determine if they are\n * equivalent.\n *\n * **Note:** This method supports comparing arrays, array buffers, booleans,\n * date objects, error objects, maps, numbers, `Object` objects, regexes,\n * sets, strings, symbols, and typed arrays. `Object` objects are compared\n * by their own, not inherited, enumerable properties. Functions and DOM\n * nodes are compared by strict equality, i.e. `===`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.isEqual(object, other);\n * // => true\n *\n * object === other;\n * // => false\n */\n\n\nfunction isEqual(value, other) {\n  return baseIsEqual(value, other);\n}\n\nmodule.exports = isEqual;","'use strict';import _jsx from\"@babel/runtime/helpers/esm/jsx\";import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";var _class;import\"core-js/modules/web.dom-collections.iterator.js\";import React from'react';import{withRouter}from'react-router-dom';// import classNames from 'classnames';\n// import { injectIntl, defineMessages } from 'react-intl';\n// import Icon from 'soapbox/components/icon';\nimport SubNavigation from'soapbox/components/sub_navigation';// const messages = defineMessages({\n//   show: { id: 'column_header.show_settings', defaultMessage: 'Show settings' },\n//   hide: { id: 'column_header.hide_settings', defaultMessage: 'Hide settings' },\n// });\nlet ColumnHeader=withRouter(_class=class ColumnHeader extends React.PureComponent{constructor(){super(...arguments);_defineProperty(this,\"state\",{collapsed:true,animating:false});_defineProperty(this,\"historyBack\",()=>{var _window$history;if(((_window$history=window.history)===null||_window$history===void 0?void 0:_window$history.length)===1){this.props.history.push('/');}else{this.props.history.goBack();}});_defineProperty(this,\"handleToggleClick\",e=>{e.stopPropagation();this.setState({collapsed:!this.state.collapsed,animating:true});});_defineProperty(this,\"handleBackClick\",()=>{this.historyBack();});_defineProperty(this,\"handleTransitionEnd\",()=>{this.setState({animating:false});});}render(){const{title}=this.props;return/*#__PURE__*/_jsx(SubNavigation,{message:title});}// render() {\n//   const { title, icon, active, children, extraButton, intl: { formatMessage } } = this.props;\n//   const { collapsed, animating } = this.state;\n//\n//   const wrapperClassName = classNames('column-header__wrapper', {\n//     'active': active,\n//   });\n//\n//   const buttonClassName = classNames('column-header', {\n//     'active': active,\n//   });\n//\n//   const collapsibleClassName = classNames('column-header__collapsible', {\n//     'collapsed': collapsed,\n//     'animating': animating,\n//   });\n//\n//   const collapsibleButtonClassName = classNames('column-header__button', {\n//     'active': !collapsed,\n//   });\n//\n//   let extraContent, collapseButton;\n//\n//   if (children) {\n//     extraContent = (\n//       <div key='extra-content' className='column-header__collapsible__extra'>\n//         {children}\n//       </div>\n//     );\n//   }\n//\n//   const collapsedContent = [\n//     extraContent,\n//   ];\n//\n//   if (children) {\n//     collapseButton = <button className={collapsibleButtonClassName} title={formatMessage(collapsed ? messages.show : messages.hide)} aria-label={formatMessage(collapsed ? messages.show : messages.hide)} aria-pressed={collapsed ? 'false' : 'true'} onClick={this.handleToggleClick}><Icon id='cog' /></button>;\n//   }\n//\n//   const hasTitle = icon && title;\n//\n//   return (\n//     <div className={wrapperClassName}>\n//       <h1 className={buttonClassName}>\n//         {hasTitle && (\n//           <button>\n//             <Icon id={icon} fixedWidth className='column-header__icon' />\n//             {title}\n//           </button>\n//         )}\n//\n//         <div className='column-header__buttons'>\n//           {extraButton}\n//           {collapseButton}\n//         </div>\n//       </h1>\n//\n//       <div className={collapsibleClassName} tabIndex={collapsed ? -1 : null} onTransitionEnd={this.handleTransitionEnd}>\n//         <div className='column-header__collapsible-inner'>\n//           {(!collapsed || animating) && collapsedContent}\n//         </div>\n//       </div>\n//     </div>\n//   );\n// }\n})||_class;export{ColumnHeader as default};","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import\"core-js/modules/web.dom-collections.iterator.js\";import\"core-js/modules/es.array.includes.js\";import isEqual from'lodash/isEqual';import React from'react';import{FormattedMessage}from'react-intl';import{useParams}from'react-router-dom';import{unfollowTag,followTag}from'soapbox/actions/tags';import Icon from'soapbox/components/icon';import{useAppDispatch,useAppSelector}from'soapbox/hooks';import{connectHashtagStream}from'../../actions/streaming';import{expandHashtagTimeline,clearTimeline}from'../../actions/timelines';import ColumnHeader from'../../components/column_header';import{Button,Column,Spinner}from'../../components/ui';import Timeline from'../ui/components/timeline';const FollowButton=_ref=>{let{id}=_ref;const{isFollow,loading}=useAppSelector(state=>({loading:state.tags.loading,isFollow:state.tags.list.find(t=>t.name.toLowerCase()===id.toLowerCase())}));const dispatch=useAppDispatch();const onClick=React.useCallback(()=>{const action=isFollow?unfollowTag:followTag;dispatch(action(id));},[isFollow,id]);const text=React.useMemo(()=>{if(loading)return/*#__PURE__*/_jsx(FormattedMessage,{id:\"hashtag_timeline.loading\",defaultMessage:\"Loading...\"});return isFollow?/*#__PURE__*/_jsx(FormattedMessage,{id:\"hashtag_timeline.unfollow\",defaultMessage:\"Unfollow tag\"}):/*#__PURE__*/_jsx(FormattedMessage,{id:\"hashtag_timeline.follow\",defaultMessage:\"Follow this tag\"});},[loading,isFollow]);return/*#__PURE__*/_jsx(Button,{disabled:loading,theme:isFollow?'secondary':'primary',size:\"sm\",onClick:onClick},void 0,loading?/*#__PURE__*/_jsx(Spinner,{withText:false,size:16}):/*#__PURE__*/_jsx(Icon,{src:isFollow?require('@tabler/icons/minus.svg'):require('@tabler/icons/plus.svg'),className:\"mr-1\"}),\"\\xA0\",text);};const HashtagTimeline=()=>{const dispatch=useAppDispatch();const disconnects=React.useRef([]);const{id,tags}=useParams();const prevParams=React.useRef({id,tags});const isLoggedIn=useAppSelector(state=>state.me);const hasUnread=useAppSelector(state=>state.getIn(['timelines',\"hashtag:\".concat(id),'unread'])>0);// TODO: wtf is this?\n// It exists in Mastodon's codebase, but undocumented\nconst additionalFor=React.useCallback(mode=>{if(tags&&(tags[mode]||[]).length>0){return tags[mode].map(tag=>tag.value).join('/');}else{return'';}},[tags]);const title=React.useMemo(()=>{const t=[\"#\".concat(id)];// TODO: wtf is all this?\n// It exists in Mastodon's codebase, but undocumented\nif(additionalFor('any')){t.push(' ',/*#__PURE__*/_jsx(FormattedMessage,{id:\"hashtag.column_header.tag_mode.any\",values:{additional:additionalFor('any')},defaultMessage:\"or {additional}\"},\"any\"));}if(additionalFor('all')){t.push(' ',/*#__PURE__*/_jsx(FormattedMessage,{id:\"hashtag.column_header.tag_mode.all\",values:{additional:additionalFor('all')},defaultMessage:\"and {additional}\"},\"all\"));}if(additionalFor('none')){t.push(' ',/*#__PURE__*/_jsx(FormattedMessage,{id:\"hashtag.column_header.tag_mode.none\",values:{additional:additionalFor('none')},defaultMessage:\"without {additional}\"},\"none\"));}return t;},[id,additionalFor]);const subscribe=React.useCallback(function(dispatch,_id){let tags=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};const any=(tags.any||[]).map(tag=>tag.value);const all=(tags.all||[]).map(tag=>tag.value);const none=(tags.none||[]).map(tag=>tag.value);[_id,...any].map(tag=>{disconnects.current.push(dispatch(connectHashtagStream(_id,tag,status=>{const tags=status.tags.map(tag=>tag.name);return all.filter(tag=>tags.includes(tag)).length===all.length&&none.filter(tag=>tags.includes(tag)).length===0;})));});},[]);const unsubscribe=React.useCallback(()=>{disconnects.current.map(d=>d());disconnects.current=[];},[]);React.useEffect(()=>{const{id:prevId,tags:prevTags}=prevParams.current;if(id!==prevId||!isEqual(tags,prevTags)){dispatch(clearTimeline(\"hashtag:\".concat(id)));}subscribe(dispatch,id,tags);dispatch(expandHashtagTimeline(id,{tags}));return()=>{unsubscribe();};},[dispatch,tags,id,subscribe,unsubscribe]);const handleLoadMore=React.useCallback(maxId=>{dispatch(expandHashtagTimeline(id,{maxId,tags}));},[dispatch,id,tags]);return/*#__PURE__*/_jsx(Column,{label:\"#\".concat(id),transparent:true,withHeader:false},void 0,/*#__PURE__*/_jsx(\"div\",{className:\"px-4 pt-4 sm:p-0\"},void 0,/*#__PURE__*/_jsx(ColumnHeader,{active:hasUnread,title:/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-between items-center\"},void 0,title,isLoggedIn&&/*#__PURE__*/_jsx(FollowButton,{id:id}))})),/*#__PURE__*/_jsx(Timeline,{scrollKey:\"hashtag_timeline\",timelineId:\"hashtag:\".concat(id),onLoadMore:handleLoadMore,emptyMessage:/*#__PURE__*/_jsx(FormattedMessage,{id:\"empty_column.hashtag\",defaultMessage:\"There is nothing in this hashtag yet.\"}),divideType:\"space\"}));};export default HashtagTimeline;"],"names":["baseIsEqual","module","exports","value","other","_class","ColumnHeader","arguments","collapsed","animating","_window$history","window","history","length","props","push","goBack","e","stopPropagation","setState","state","historyBack","render","title","this","message","FollowButton","_ref","id","loading","tags","isFollow","list","find","t","name","toLowerCase","dispatch","onClick","action","text","defaultMessage","disabled","theme","size","withText","src","className","disconnects","prevParams","isLoggedIn","me","hasUnread","getIn","concat","additionalFor","mode","map","tag","join","values","additional","subscribe","_id","undefined","any","all","none","current","status","filter","includes","unsubscribe","d","prevId","prevTags","handleLoadMore","maxId","label","transparent","withHeader","active","scrollKey","timelineId","onLoadMore","emptyMessage","divideType"],"sourceRoot":""}