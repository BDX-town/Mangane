{"version":3,"file":"packs/js/features/account_gallery-a1203cb665a9ece6a28a.chunk.js","mappings":"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","sources":["webpack://mangane-fe/./app/soapbox/features/account_gallery/components/media_item.tsx","webpack://mangane-fe/./app/soapbox/features/account_gallery/index.tsx","webpack://mangane-fe/./app/soapbox/features/ui/components/profile_media_panel.tsx"],"sourcesContent":["import _extends from\"@babel/runtime/helpers/esm/extends\";import _jsx from\"@babel/runtime/helpers/esm/jsx\";import\"core-js/modules/web.dom-collections.iterator.js\";import\"core-js/modules/es.array.includes.js\";import classNames from'classnames';import React,{useState}from'react';import Blurhash from'soapbox/components/blurhash';import Icon from'soapbox/components/icon';import StillImage from'soapbox/components/still_image';import{useSettings}from'soapbox/hooks';import{isIOS}from'soapbox/is_mobile';const MediaItem=_ref=>{var _attachment$status;let{attachment,displayWidth,onOpenMedia}=_ref;const settings=useSettings();const autoPlayGif=settings.get('autoPlayGif');const displayMedia=settings.get('displayMedia');const[visible,setVisible]=useState(displayMedia!=='hide_all'&&!((_attachment$status=attachment.status)!==null&&_attachment$status!==void 0&&_attachment$status.sensitive)||displayMedia==='show_all');const handleMouseEnter=e=>{const video=e.target;if(hoverToPlay()){video.play();}};const handleMouseLeave=e=>{const video=e.target;if(hoverToPlay()){video.pause();video.currentTime=0;}};const hoverToPlay=()=>{return!autoPlayGif&&['gifv','video'].includes(attachment.type);};const handleClick=e=>{if(e.button===0&&!(e.ctrlKey||e.metaKey)){e.preventDefault();if(visible){onOpenMedia(attachment);}else{setVisible(true);}}};const width=\"\".concat(Math.floor((displayWidth-4)/3)-4,\"px\");const height=width;const status=attachment.get('status');const title=status.get('spoiler_text')||attachment.get('description');let thumbnail='';let icon;if(attachment.type==='unknown'){// Skip\n}else if(attachment.type==='image'){const focusX=Number(attachment.getIn(['meta','focus','x']))||0;const focusY=Number(attachment.getIn(['meta','focus','y']))||0;const x=(focusX/2+.5)*100;const y=(focusY/-2+.5)*100;thumbnail=/*#__PURE__*/_jsx(StillImage,{src:attachment.preview_url,alt:attachment.description,style:{objectPosition:\"\".concat(x,\"% \").concat(y,\"%\")}});}else if(['gifv','video'].indexOf(attachment.type)!==-1){const conditionalAttributes={};if(isIOS()){conditionalAttributes.playsInline=true;}if(autoPlayGif){conditionalAttributes.autoPlay=true;}thumbnail=/*#__PURE__*/_jsx(\"div\",{className:classNames('media-gallery__gifv',{autoplay:autoPlayGif})},void 0,/*#__PURE__*/React.createElement(\"video\",_extends({className:\"media-gallery__item-gifv-thumbnail\",\"aria-label\":attachment.description,title:attachment.description,role:\"application\",src:attachment.url,onMouseEnter:handleMouseEnter,onMouseLeave:handleMouseLeave,loop:true,muted:true},conditionalAttributes)),/*#__PURE__*/_jsx(\"span\",{className:\"media-gallery__gifv__label\"},void 0,\"GIF\"));}else if(attachment.type==='audio'){const remoteURL=attachment.remote_url||'';const fileExtensionLastIndex=remoteURL.lastIndexOf('.');const fileExtension=remoteURL.substr(fileExtensionLastIndex+1).toUpperCase();thumbnail=/*#__PURE__*/_jsx(\"div\",{className:\"media-gallery__item-thumbnail\"},void 0,/*#__PURE__*/_jsx(\"span\",{className:\"media-gallery__item__icons\"},void 0,/*#__PURE__*/_jsx(Icon,{src:require('@tabler/icons/volume.svg')})),/*#__PURE__*/_jsx(\"span\",{className:\"media-gallery__file-extension__label\"},void 0,fileExtension));}if(!visible){icon=/*#__PURE__*/_jsx(\"span\",{className:\"account-gallery__item__icons\"},void 0,/*#__PURE__*/_jsx(Icon,{src:require('@tabler/icons/eye-off.svg')}));}return/*#__PURE__*/_jsx(\"div\",{className:\"account-gallery__item\",style:{width,height}},void 0,/*#__PURE__*/_jsx(\"a\",{className:\"media-gallery__item-thumbnail rounded overflow-hidden\",href:status.get('url'),target:\"_blank\",onClick:handleClick,title:title},void 0,/*#__PURE__*/_jsx(Blurhash,{hash:attachment.get('blurhash'),className:classNames('media-gallery__preview',{'media-gallery__preview--hidden':visible})}),visible&&thumbnail,!visible&&icon));};export default MediaItem;","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import\"core-js/modules/web.dom-collections.iterator.js\";import React,{useEffect,useState}from'react';import{FormattedMessage}from'react-intl';import{useParams}from'react-router-dom';import{fetchAccount,fetchAccountByUsername}from'soapbox/actions/accounts';import{openModal}from'soapbox/actions/modals';import{expandAccountMediaTimeline}from'soapbox/actions/timelines';import LoadMore from'soapbox/components/load_more';import MissingIndicator from'soapbox/components/missing_indicator';import{Column,Spinner}from'soapbox/components/ui';import{useAppDispatch,useAppSelector}from'soapbox/hooks';import{getAccountGallery,findAccountByUsername}from'soapbox/selectors';import{getFeatures}from'soapbox/utils/features';import MediaItem from'./components/media_item';const LoadMoreMedia=_ref=>{let{maxId,onLoadMore}=_ref;const handleLoadMore=()=>{onLoadMore(maxId);};return/*#__PURE__*/_jsx(LoadMore,{onClick:handleLoadMore});};const AccountGallery=()=>{const dispatch=useAppDispatch();const{username}=useParams();const{accountId,unavailable,accountUsername}=useAppSelector(state=>{var _state$accounts$get,_state$relationships$;const me=state.me;const accountFetchError=(((_state$accounts$get=state.accounts.get(-1))===null||_state$accounts$get===void 0?void 0:_state$accounts$get.username)||'').toLowerCase()===username.toLowerCase();const features=getFeatures(state.instance);let accountId=-1;let accountUsername=username;if(accountFetchError){accountId=null;}else{const account=findAccountByUsername(state,username);accountId=account?account.id||null:-1;accountUsername=(account===null||account===void 0?void 0:account.acct)||'';}const isBlocked=((_state$relationships$=state.relationships.get(String(accountId)))===null||_state$relationships$===void 0?void 0:_state$relationships$.blocked_by)||false;return{accountId,unavailable:me===accountId?false:isBlocked&&!features.blockersVisible,accountUsername};});const isAccount=useAppSelector(state=>!!state.accounts.get(accountId));const attachments=useAppSelector(state=>getAccountGallery(state,accountId));const isLoading=useAppSelector(state=>{var _state$timelines$get;return(_state$timelines$get=state.timelines.get(\"account:\".concat(accountId,\":media\")))===null||_state$timelines$get===void 0?void 0:_state$timelines$get.isLoading;});const hasMore=useAppSelector(state=>{var _state$timelines$get2;return(_state$timelines$get2=state.timelines.get(\"account:\".concat(accountId,\":media\")))===null||_state$timelines$get2===void 0?void 0:_state$timelines$get2.hasMore;});const[width,setWidth]=useState(323);const handleRef=c=>{if(c)setWidth(c.offsetWidth);};const handleScrollToBottom=()=>{if(hasMore){handleLoadMore(attachments.size>0?attachments.last().status.id:undefined);}};const handleLoadMore=maxId=>{if(accountId&&accountId!==-1){dispatch(expandAccountMediaTimeline(accountId,{maxId}));}};const handleLoadOlder=e=>{e.preventDefault();handleScrollToBottom();};const handleOpenMedia=attachment=>{if(attachment.type==='video'){dispatch(openModal('VIDEO',{media:attachment,status:attachment.status,account:attachment.account}));}else{const media=attachment.status.media_attachments;const index=media.findIndex(x=>x.id===attachment.id);dispatch(openModal('MEDIA',{media,index,status:attachment.status,account:attachment.account}));}};useEffect(()=>{if(accountId&&accountId!==-1){dispatch(fetchAccount(accountId));dispatch(expandAccountMediaTimeline(accountId));}else{dispatch(fetchAccountByUsername(username));}},[accountId]);if(!isAccount&&accountId!==-1){return/*#__PURE__*/_jsx(MissingIndicator,{});}if(accountId===-1||!attachments&&isLoading){return/*#__PURE__*/_jsx(Column,{},void 0,/*#__PURE__*/_jsx(Spinner,{}));}let loadOlder=null;if(hasMore&&!(isLoading&&attachments.size===0)){loadOlder=/*#__PURE__*/_jsx(LoadMore,{visible:!isLoading,onClick:handleLoadOlder});}if(unavailable){return/*#__PURE__*/_jsx(Column,{},void 0,/*#__PURE__*/_jsx(\"div\",{className:\"empty-column-indicator\"},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"empty_column.account_unavailable\",defaultMessage:\"Profile unavailable\"})));}return/*#__PURE__*/_jsx(Column,{label:\"@\".concat(accountUsername),transparent:true,withHeader:false},void 0,/*#__PURE__*/React.createElement(\"div\",{role:\"feed\",className:\"account-gallery__container\",ref:handleRef},attachments.map((attachment,index)=>{var _attachments$get,_attachments$get2;return attachment===null?/*#__PURE__*/_jsx(LoadMoreMedia,{maxId:index>0?((_attachments$get2=attachments.get(index-1))===null||_attachments$get2===void 0?void 0:_attachments$get2.id)||null:null,onLoadMore:handleLoadMore},'more:'+((_attachments$get=attachments.get(index+1))===null||_attachments$get===void 0?void 0:_attachments$get.id)):/*#__PURE__*/_jsx(MediaItem,{attachment:attachment,displayWidth:width,onOpenMedia:handleOpenMedia},\"\".concat(attachment.status.id,\"+\").concat(attachment.id));}),!isLoading&&attachments.size===0&&/*#__PURE__*/_jsx(\"div\",{className:\"empty-column-indicator\"},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"account_gallery.none\",defaultMessage:\"No media to show.\"})),loadOlder),isLoading&&attachments.size===0&&/*#__PURE__*/_jsx(\"div\",{className:\"slist__append\"},void 0,/*#__PURE__*/_jsx(Spinner,{})));};export default AccountGallery;","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import\"core-js/modules/web.dom-collections.iterator.js\";import{List as ImmutableList}from'immutable';import React,{useState,useEffect}from'react';import{FormattedMessage}from'react-intl';import{useDispatch}from'react-redux';import{openModal}from'soapbox/actions/modals';import{expandAccountMediaTimeline}from'soapbox/actions/timelines';import{Spinner,Widget}from'soapbox/components/ui';import{useAppSelector}from'soapbox/hooks';import{getAccountGallery}from'soapbox/selectors';import MediaItem from'../../account_gallery/components/media_item';const ProfileMediaPanel=_ref=>{let{account}=_ref;const dispatch=useDispatch();const[loading,setLoading]=useState(true);const attachments=useAppSelector(state=>account?getAccountGallery(state,account===null||account===void 0?void 0:account.id):ImmutableList());const handleOpenMedia=attachment=>{if(attachment.type==='video'){dispatch(openModal('VIDEO',{media:attachment,status:attachment.status}));}else{const media=attachment.getIn(['status','media_attachments']);const index=media.findIndex(x=>x.id===attachment.id);dispatch(openModal('MEDIA',{media,index,status:attachment.status,account:attachment.account}));}};useEffect(()=>{setLoading(true);if(account){dispatch(expandAccountMediaTimeline(account.id))// @ts-ignore yes it does\n.then(()=>setLoading(false)).catch(()=>{});}},[account===null||account===void 0?void 0:account.id]);const renderAttachments=()=>{const publicAttachments=attachments.filter(attachment=>attachment.getIn(['status','visibility'])==='public');const nineAttachments=publicAttachments.slice(0,9);if(!nineAttachments.isEmpty()){return/*#__PURE__*/_jsx(\"div\",{className:\"media-panel__list\"},void 0,nineAttachments.map((attachment,_index)=>/*#__PURE__*/_jsx(MediaItem,{attachment:attachment,displayWidth:255,onOpenMedia:handleOpenMedia},\"\".concat(attachment.getIn(['status','id']),\"+\").concat(attachment.id))));}else{return/*#__PURE__*/_jsx(\"div\",{className:\"media-panel__empty\"},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"media_panel.empty_message\",defaultMessage:\"No media found.\"}));}};return/*#__PURE__*/_jsx(Widget,{title:/*#__PURE__*/_jsx(FormattedMessage,{id:\"media_panel.title\",defaultMessage:\"Media\"})},void 0,account&&/*#__PURE__*/_jsx(\"div\",{className:\"media-panel__content\"},void 0,loading?/*#__PURE__*/_jsx(Spinner,{}):renderAttachments()));};export default ProfileMediaPanel;"],"names":["_ref","_attachment$status","icon","attachment","displayWidth","onOpenMedia","settings","autoPlayGif","get","displayMedia","useState","status","sensitive","visible","setVisible","hoverToPlay","includes","type","width","concat","Math","floor","height","title","thumbnail","x","Number","getIn","y","src","preview_url","alt","description","style","objectPosition","indexOf","conditionalAttributes","playsInline","autoPlay","className","autoplay","role","url","onMouseEnter","e","video","target","play","onMouseLeave","pause","currentTime","loop","muted","remoteURL","remote_url","fileExtensionLastIndex","lastIndexOf","fileExtension","substr","toUpperCase","href","onClick","button","ctrlKey","metaKey","preventDefault","hash","LoadMoreMedia","maxId","onLoadMore","dispatch","username","state","_state$accounts$get","_state$relationships$","me","accountFetchError","accounts","toLowerCase","features","instance","accountId","accountUsername","account","id","acct","isBlocked","relationships","String","blocked_by","unavailable","blockersVisible","isAccount","attachments","isLoading","_state$timelines$get","timelines","hasMore","_state$timelines$get2","setWidth","handleLoadMore","handleOpenMedia","media","media_attachments","index","findIndex","useEffect","loadOlder","size","last","undefined","defaultMessage","label","transparent","withHeader","ref","c","offsetWidth","map","_attachments$get","_attachments$get2","nineAttachments","loading","setLoading","then","catch","filter","slice","isEmpty","_index"],"sourceRoot":""}