"use strict";(self.webpackChunkmangane_fe=self.webpackChunkmangane_fe||[]).push([[34],{563:function(e,t,a){a.r(t),a.d(t,{default:function(){return O}});var i=a(1852),l=a(1843),o=(a(1),a(42),a(23),a(0)),s=a(1844),r=a(1845),d=a(1868),n=a(13),c=a(47),f=a(12),u=a(1874),h=a(273),p=a(2),g=a(936),v=a(3),_=a(32),Z=a(261),b=a(96),m=a(118),w=function(e){var t=e.account,a=(0,v.Dn)().displayFqn;return(0,i.Z)("div",{className:"bg-white dark:bg-slate-800 rounded-lg text-black dark:text-white sm:shadow dark:sm:shadow-inset overflow-hidden"},void 0,(0,i.Z)("div",{},void 0,(0,i.Z)("div",{className:"relative w-full h-32 md:rounded-t-lg bg-gray-200 dark:bg-slate-900/50"},void 0,(0,i.Z)(b.Z,{alt:"",src:t.header,className:"absolute inset-0 object-cover md:rounded-t-lg"}))),(0,i.Z)(p.Ug,{space:3,alignItems:"center",className:"p-3"},void 0,(0,i.Z)("div",{className:"relative"},void 0,(0,i.Z)("div",{className:"h-12 w-12 bg-gray-400 rounded-full"},void 0,(0,i.Z)(b.Z,{alt:"",className:"h-12 w-12 rounded-full",src:t.avatar})),t.verified&&(0,i.Z)("div",{className:"absolute -top-1.5 -right-1.5"},void 0,(0,i.Z)(m.Z,{}))),(0,i.Z)(p.Kq,{className:"truncate"},void 0,(0,i.Z)(p.xv,{weight:"medium",size:"sm",truncate:!0},void 0,t.display_name),(0,i.Z)(p.xv,{theme:"muted",size:"sm"},void 0,"@",a?t.fqn:t.acct))))},y=function(e,t,a){if(a||2===arguments.length)for(var i,l=0,o=t.length;l<o;l++)!i&&l in t||(i||(i=Array.prototype.slice.call(t,0,l)),i[l]=t[l]);return e.concat(i||Array.prototype.slice.call(t))};function M(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?M(Object(a),!0).forEach((function(t){(0,l.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):M(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var x=function(e){var t=e.pleroma.toJS(),a=t.hide_followers,i=t.hide_follows,l=t.hide_followers_count,o=t.hide_follows_count;return Boolean(a&&i&&l&&o)},P=(0,s.vU)({heading:{id:"column.edit_profile",defaultMessage:"Edit profile"},header:{id:"edit_profile.header",defaultMessage:"Edit Profile"},metaFieldLabel:{id:"edit_profile.fields.meta_fields.label_placeholder",defaultMessage:"Label"},metaFieldContent:{id:"edit_profile.fields.meta_fields.content_placeholder",defaultMessage:"Content"},success:{id:"edit_profile.success",defaultMessage:"Profile saved!"},error:{id:"edit_profile.error",defaultMessage:"Profile update failed"},bioPlaceholder:{id:"edit_profile.fields.bio_placeholder",defaultMessage:"Tell us about yourself."},displayNamePlaceholder:{id:"edit_profile.fields.display_name_placeholder",defaultMessage:"Name"},websitePlaceholder:{id:"edit_profile.fields.website_placeholder",defaultMessage:"Display a Link"},locationPlaceholder:{id:"edit_profile.fields.location_placeholder",defaultMessage:"Location"},cancel:{id:"common.cancel",defaultMessage:"Cancel"}}),C=function(e){var t=e.value,a=e.onChange,l=(0,r.Z)(),o=function(e){return function(i){var l;a(k(k({},t),{},((l={})[e]=i.currentTarget.value,l)))}};return(0,i.Z)(p.Ug,{space:2,grow:!0},void 0,(0,i.Z)(p.II,{type:"text",outerClassName:"w-2/5 flex-grow",value:t.name,onChange:o("name"),placeholder:l.formatMessage(P.metaFieldLabel)}),(0,i.Z)(p.II,{type:"text",outerClassName:"w-3/5 flex-grow",value:t.value,onChange:o("value"),placeholder:l.formatMessage(P.metaFieldContent)}))},O=function(){var e=(0,r.Z)(),t=(0,v.TL)(),a=(0,v.Tr)(),l=(0,v.hz)(),s=(0,v.CG)((function(e){return e.instance.pleroma.getIn(["metadata","fields_limits","max_fields"],4)})),b=(0,o.useState)(!1),m=b[0],M=b[1],O=(0,o.useState)({}),I=O[0],N=O[1],D=(0,o.useState)(!1),T=D[0],S=D[1];(0,o.useEffect)((function(){if(a){var e=function(e){var t=x(e);return{discoverable:e.discoverable,bot:e.bot,display_name:e.display_name,note:e.source.get("note"),locked:e.locked,fields_attributes:y([],e.source.get("fields",[]).toJS(),!0),stranger_notifications:!0===e.getIn(["pleroma","notification_settings","block_from_strangers"]),accepts_email_list:!0===e.getIn(["pleroma","accepts_email_list"]),hide_followers:t,hide_follows:t,hide_followers_count:t,hide_follows_count:t,website:e.website,location:e.location,birthday:e.birthday}}(a),t=!0===a.getIn(["pleroma","notification_settings","block_from_strangers"]);N(e),S(t)}}),[null==a?void 0:a.id]);var j=function(e,t){N((function(a){var i;return k(k({},a),{},((i={})[e]=t,i))}))},L=function(e){return function(t){j(e,t.target.checked)}},z=function(e){return function(t){j(e,t.target.value)}},F=function(e,t){return function(a){var i,l=null===(i=a.target.files)||void 0===i?void 0:i.item(0);l&&(0,Z.Z)(l,t).then((function(t){j(e,t)})).catch(console.error)}},U=(0,o.useMemo)((function(){return I.avatar?URL.createObjectURL(I.avatar):null==a?void 0:a.avatar}),[I.avatar,null==a?void 0:a.avatar]),G=(0,o.useMemo)((function(){return I.header?URL.createObjectURL(I.header):null==a?void 0:a.header}),[I.header,null==a?void 0:a.header]),H=(0,o.useMemo)((function(){return(0,_.WT)(k(k(k({},null==a?void 0:a.toJS()),I),{},{avatar:U,header:G}))}),[null==a?void 0:a.id,I.display_name,U,G]);return(0,i.Z)(p.sg,{label:e.formatMessage(P.header)},void 0,(0,i.Z)(p.l0,{onSubmit:function(a){var i=[];i.push(t((0,c.sQ)(I,!0))),l.muteStrangers&&i.push(t((0,n.lUE)({block_from_strangers:T})).catch(console.error)),M(!0),Promise.all(i).then((function(){M(!1),t(f.ZP.success(e.formatMessage(P.success)))})).catch((function(){M(!1),t(f.ZP.error(e.formatMessage(P.error)))})),a.preventDefault()}},void 0,(0,i.Z)(p.cw,{labelText:(0,i.Z)(d.Z,{id:"edit_profile.fields.display_name_label",defaultMessage:"Display name"})},void 0,(0,i.Z)(p.II,{type:"text",value:I.display_name,onChange:z("display_name"),placeholder:e.formatMessage(P.displayNamePlaceholder)})),l.birthdays&&(0,i.Z)(p.cw,{labelText:(0,i.Z)(d.Z,{id:"edit_profile.fields.birthday_label",defaultMessage:"Birthday"})},void 0,(0,i.Z)(u.Z,{value:I.birthday,onChange:function(e){j("birthday",e)}})),l.accountLocation&&(0,i.Z)(p.cw,{labelText:(0,i.Z)(d.Z,{id:"edit_profile.fields.location_label",defaultMessage:"Location"})},void 0,(0,i.Z)(p.II,{type:"text",value:I.location,onChange:z("location"),placeholder:e.formatMessage(P.locationPlaceholder)})),l.accountWebsite&&(0,i.Z)(p.cw,{labelText:(0,i.Z)(d.Z,{id:"edit_profile.fields.website_label",defaultMessage:"Website"})},void 0,(0,i.Z)(p.II,{type:"text",value:I.website,onChange:z("website"),placeholder:e.formatMessage(P.websitePlaceholder)})),(0,i.Z)(p.cw,{labelText:(0,i.Z)(d.Z,{id:"edit_profile.fields.bio_label",defaultMessage:"Bio"})},void 0,(0,i.Z)(p.gx,{value:I.note,onChange:z("note"),autoComplete:"off",placeholder:e.formatMessage(P.bioPlaceholder)})),(0,i.Z)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},void 0,(0,i.Z)(w,{account:H}),(0,i.Z)("div",{className:"space-y-4"},void 0,(0,i.Z)(p.cw,{labelText:(0,i.Z)(d.Z,{id:"edit_profile.fields.header_label",defaultMessage:"Choose Background Picture"}),hintText:(0,i.Z)(d.Z,{id:"edit_profile.hints.header",defaultMessage:"PNG, GIF or JPG. Will be downscaled to {size}",values:{size:"1920x1080px"}})},void 0,(0,i.Z)(p.S2,{onChange:F("header",2073600)})),(0,i.Z)(p.cw,{labelText:(0,i.Z)(d.Z,{id:"edit_profile.fields.avatar_label",defaultMessage:"Choose Profile Picture"}),hintText:(0,i.Z)(d.Z,{id:"edit_profile.hints.avatar",defaultMessage:"PNG, GIF or JPG. Will be downscaled to {size}",values:{size:"400x400px"}})},void 0,(0,i.Z)(p.S2,{onChange:F("avatar",16e4)})))),(0,i.Z)(h.Z,{},void 0,l.followRequests&&(0,i.Z)(h.H,{label:(0,i.Z)(d.Z,{id:"edit_profile.fields.locked_label",defaultMessage:"Lock account"}),hint:(0,i.Z)(d.Z,{id:"edit_profile.hints.locked",defaultMessage:"Requires you to manually approve followers"})},void 0,(0,i.Z)(p.ZD,{checked:I.locked,onChange:L("locked")})),l.hideNetwork&&(0,i.Z)(h.H,{label:(0,i.Z)(d.Z,{id:"edit_profile.fields.hide_network_label",defaultMessage:"Hide network"}),hint:(0,i.Z)(d.Z,{id:"edit_profile.hints.hide_network",defaultMessage:"Who you follow and who follows you will not be shown on your profile"})},void 0,(0,i.Z)(p.ZD,{checked:!!a&&x(a),onChange:function(e){var t=e.target.checked;N((function(e){return k(k({},e),{},{hide_followers:t,hide_follows:t,hide_followers_count:t,hide_follows_count:t})}))}})),l.bots&&(0,i.Z)(h.H,{label:(0,i.Z)(d.Z,{id:"edit_profile.fields.bot_label",defaultMessage:"This is a bot account"}),hint:(0,i.Z)(d.Z,{id:"edit_profile.hints.bot",defaultMessage:"This account mainly performs automated actions and might not be monitored"})},void 0,(0,i.Z)(p.ZD,{checked:I.bot,onChange:L("bot")})),l.muteStrangers&&(0,i.Z)(h.H,{label:(0,i.Z)(d.Z,{id:"edit_profile.fields.stranger_notifications_label",defaultMessage:"Block notifications from strangers"}),hint:(0,i.Z)(d.Z,{id:"edit_profile.hints.stranger_notifications",defaultMessage:"Only show notifications from people you follow"})},void 0,(0,i.Z)(p.ZD,{checked:T,onChange:function(e){return S(e.target.checked)}})),l.profileDirectory&&(0,i.Z)(h.H,{label:(0,i.Z)(d.Z,{id:"edit_profile.fields.discoverable_label",defaultMessage:"Allow account discovery"}),hint:(0,i.Z)(d.Z,{id:"edit_profile.hints.discoverable",defaultMessage:"Display account in profile directory and allow indexing by external services"})},void 0,(0,i.Z)(p.ZD,{checked:I.discoverable,onChange:L("discoverable")})),l.emailList&&(0,i.Z)(h.H,{label:(0,i.Z)(d.Z,{id:"edit_profile.fields.accepts_email_list_label",defaultMessage:"Subscribe to newsletter"}),hint:(0,i.Z)(d.Z,{id:"edit_profile.hints.accepts_email_list",defaultMessage:"Opt-in to news and marketing updates."})},void 0,(0,i.Z)(p.ZD,{checked:I.accepts_email_list,onChange:L("accepts_email_list")}))),l.profileFields&&(0,i.Z)(g.Z,{label:(0,i.Z)(d.Z,{id:"edit_profile.fields.meta_fields_label",defaultMessage:"Profile fields"}),hint:(0,i.Z)(d.Z,{id:"edit_profile.hints.meta_fields",defaultMessage:"You can have up to {count, plural, one {# custom field} other {# custom fields}} displayed on your profile.",values:{count:s}}),values:I.fields_attributes||[],onChange:function(e){j("fields_attributes",e)},onAddItem:function(){var e=I.fields_attributes||[],t=y(y([],e,!0),[{name:"",value:""}],!1);j("fields_attributes",t)},onRemoveItem:function(e){var t=I.fields_attributes||[],a=y([],t,!0);a.splice(e,1),j("fields_attributes",a)},component:C,maxItems:s}),(0,i.Z)(p.iN,{},void 0,(0,i.Z)(p.zx,{to:"/settings",theme:"ghost"},void 0,e.formatMessage(P.cancel)),(0,i.Z)(p.zx,{theme:"primary",type:"submit",disabled:m},void 0,(0,i.Z)(d.Z,{id:"edit_profile.save",defaultMessage:"Save"})))))}}}]);
//# sourceMappingURL=edit_profile-2ae3b0abed29f0adc19e.chunk.js.map