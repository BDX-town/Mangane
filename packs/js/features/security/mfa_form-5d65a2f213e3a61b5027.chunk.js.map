{"version":3,"file":"packs/js/features/security/mfa_form-5d65a2f213e3a61b5027.chunk.js","mappings":"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","sources":["webpack://mangane-fe/./app/soapbox/features/security/mfa/disable_otp_form.tsx","webpack://mangane-fe/./app/soapbox/features/security/mfa/enable_otp_form.tsx","webpack://mangane-fe/./app/soapbox/features/security/mfa/otp_confirm_form.tsx","webpack://mangane-fe/./app/soapbox/features/security/mfa_form.tsx"],"sourcesContent":["import _jsx from\"@babel/runtime/helpers/esm/jsx\";import\"core-js/modules/web.dom-collections.iterator.js\";import\"core-js/modules/es.promise.finally.js\";import React,{useState,useCallback}from'react';import{useIntl,defineMessages,FormattedMessage}from'react-intl';import{useHistory}from'react-router-dom';import{disableMfa}from'soapbox/actions/mfa';import snackbar from'soapbox/actions/snackbar';import{Button,Form,FormGroup,Input,FormActions,Stack,Text}from'soapbox/components/ui';import{useAppDispatch}from'soapbox/hooks';const messages=defineMessages({mfa_setup_disable_button:{\"id\":\"column.mfa_disable_button\",\"defaultMessage\":\"Disable\"},disableFail:{\"id\":\"security.disable.fail\",\"defaultMessage\":\"Incorrect password. Try again.\"},mfaDisableSuccess:{\"id\":\"mfa.disable.success_message\",\"defaultMessage\":\"MFA disabled\"},passwordPlaceholder:{\"id\":\"mfa.mfa_setup.password_placeholder\",\"defaultMessage\":\"Password\"}});const DisableOtpForm=()=>{const[isLoading,setIsLoading]=useState(false);const[password,setPassword]=useState('');const intl=useIntl();const dispatch=useAppDispatch();const history=useHistory();const handleSubmit=useCallback(()=>{setIsLoading(true);dispatch(disableMfa('totp',password)).then(()=>{dispatch(snackbar.success(intl.formatMessage(messages.mfaDisableSuccess)));history.push('../auth/edit');}).finally(()=>{setIsLoading(false);}).catch(()=>{dispatch(snackbar.error(intl.formatMessage(messages.disableFail)));});},[password,dispatch,intl]);const handleInputChange=event=>{setPassword(event.target.value);};return/*#__PURE__*/_jsx(Form,{onSubmit:handleSubmit},void 0,/*#__PURE__*/_jsx(Stack,{},void 0,/*#__PURE__*/_jsx(Text,{weight:\"medium\"},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"mfa.otp_enabled_title\",defaultMessage:\"OTP Enabled\"})),/*#__PURE__*/_jsx(Text,{theme:\"muted\"},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"mfa.otp_enabled_description\",defaultMessage:\"You have enabled two-factor authentication via OTP.\"}))),/*#__PURE__*/_jsx(FormGroup,{labelText:intl.formatMessage(messages.passwordPlaceholder),hintText:/*#__PURE__*/_jsx(FormattedMessage,{id:\"mfa.mfa_disable_enter_password\",defaultMessage:\"Enter your current password to disable two-factor auth.\"})},void 0,/*#__PURE__*/_jsx(Input,{type:\"password\",placeholder:intl.formatMessage(messages.passwordPlaceholder),name:\"password\",onChange:handleInputChange,disabled:isLoading,value:password,required:true})),/*#__PURE__*/_jsx(FormActions,{},void 0,/*#__PURE__*/_jsx(Button,{disabled:isLoading,theme:\"danger\",type:\"submit\",text:intl.formatMessage(messages.mfa_setup_disable_button)})));};export default DisableOtpForm;","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import\"core-js/modules/web.dom-collections.iterator.js\";import React,{useState,useEffect}from'react';import{useIntl,defineMessages,FormattedMessage}from'react-intl';import{useHistory}from'react-router-dom';import{fetchBackupCodes}from'soapbox/actions/mfa';import snackbar from'soapbox/actions/snackbar';import{Button,FormActions,Spinner,Stack,Text}from'soapbox/components/ui';import{useAppDispatch}from'soapbox/hooks';const messages=defineMessages({mfaCancelButton:{\"id\":\"column.mfa_cancel\",\"defaultMessage\":\"Cancel\"},mfaSetupButton:{\"id\":\"column.mfa_setup\",\"defaultMessage\":\"Proceed to Setup\"},codesFail:{\"id\":\"security.codes.fail\",\"defaultMessage\":\"Failed to fetch backup codes\"}});const EnableOtpForm=_ref=>{let{displayOtpForm,handleSetupProceedClick}=_ref;const dispatch=useAppDispatch();const intl=useIntl();const history=useHistory();const[backupCodes,setBackupCodes]=useState([]);useEffect(()=>{dispatch(fetchBackupCodes()).then(_ref2=>{let{codes:backupCodes}=_ref2;setBackupCodes(backupCodes);}).catch(()=>{dispatch(snackbar.error(intl.formatMessage(messages.codesFail)));});},[]);return/*#__PURE__*/_jsx(Stack,{space:4},void 0,/*#__PURE__*/_jsx(Stack,{space:2},void 0,/*#__PURE__*/_jsx(Text,{theme:\"muted\"},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"mfa.setup_warning\",defaultMessage:\"Write these codes down or save them somewhere secure - otherwise you won't see them again. If you lose access to your 2FA app and recovery codes you'll be locked out of your account.\"})),/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-100 dark:bg-slate-900/50 rounded-lg p-4\"},void 0,/*#__PURE__*/_jsx(Stack,{space:3},void 0,/*#__PURE__*/_jsx(Text,{weight:\"medium\",align:\"center\"},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"mfa.setup_recoverycodes\",defaultMessage:\"Recovery codes\"})),backupCodes.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"grid gap-3 grid-cols-2 rounded-lg text-center\"},void 0,backupCodes.map((code,i)=>/*#__PURE__*/_jsx(Text,{theme:\"muted\",size:\"sm\"},i,code))):/*#__PURE__*/_jsx(Spinner,{})))),!displayOtpForm&&/*#__PURE__*/_jsx(FormActions,{},void 0,/*#__PURE__*/_jsx(Button,{theme:\"ghost\",text:intl.formatMessage(messages.mfaCancelButton),onClick:()=>history.push('../auth/edit')}),backupCodes.length>0&&/*#__PURE__*/_jsx(Button,{theme:\"primary\",text:intl.formatMessage(messages.mfaSetupButton),onClick:handleSetupProceedClick})));};export default EnableOtpForm;","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}import\"core-js/modules/web.dom-collections.iterator.js\";import{QRCodeCanvas as QRCode}from'qrcode.react';import React,{useCallback,useEffect,useState}from'react';import{useIntl,FormattedMessage,defineMessages}from'react-intl';import{useHistory}from'react-router-dom';import{setupMfa,confirmMfa}from'soapbox/actions/mfa';import snackbar from'soapbox/actions/snackbar';import{Button,Form,FormActions,FormGroup,Input,Stack,Text}from'soapbox/components/ui';import{useAppDispatch}from'soapbox/hooks';const messages=defineMessages({mfaCancelButton:{\"id\":\"column.mfa_cancel\",\"defaultMessage\":\"Cancel\"},mfaSetupConfirmButton:{\"id\":\"column.mfa_confirm_button\",\"defaultMessage\":\"Confirm\"},confirmFail:{\"id\":\"security.confirm.fail\",\"defaultMessage\":\"Incorrect code or password. Try again.\"},qrFail:{\"id\":\"security.qr.fail\",\"defaultMessage\":\"Failed to fetch setup key\"},mfaConfirmSuccess:{\"id\":\"mfa.confirm.success_message\",\"defaultMessage\":\"MFA confirmed\"},codePlaceholder:{\"id\":\"mfa.mfa_setup.code_placeholder\",\"defaultMessage\":\"Code\"},passwordPlaceholder:{\"id\":\"mfa.mfa_setup.password_placeholder\",\"defaultMessage\":\"Password\"}});const OtpConfirmForm=()=>{const intl=useIntl();const history=useHistory();const dispatch=useAppDispatch();const[state,setState]=useState({password:'',isLoading:false,code:'',qrCodeURI:'',confirmKey:''});useEffect(()=>{dispatch(setupMfa('totp')).then(data=>{setState(prevState=>_objectSpread(_objectSpread({},prevState),{},{qrCodeURI:data.provisioning_uri,confirmKey:data.key}));}).catch(()=>{dispatch(snackbar.error(intl.formatMessage(messages.qrFail)));});},[]);const handleInputChange=useCallback(event=>{event.persist();setState(prevState=>_objectSpread(_objectSpread({},prevState),{},{[event.target.name]:event.target.value}));},[]);const handleSubmit=e=>{setState(prevState=>_objectSpread(_objectSpread({},prevState),{},{isLoading:true}));dispatch(confirmMfa('totp',state.code,state.password)).then(r=>{dispatch(snackbar.success(intl.formatMessage(messages.mfaConfirmSuccess)));history.push('../auth/edit');}).catch(()=>{dispatch(snackbar.error(intl.formatMessage(messages.confirmFail)));setState(prevState=>_objectSpread(_objectSpread({},prevState),{},{isLoading:false}));});e.preventDefault();};return/*#__PURE__*/_jsx(Stack,{space:4},void 0,/*#__PURE__*/_jsx(\"hr\",{className:\"mt-4 dark:border-slate-700\"}),/*#__PURE__*/_jsx(Form,{onSubmit:handleSubmit},void 0,/*#__PURE__*/_jsx(Stack,{},void 0,/*#__PURE__*/_jsx(Text,{weight:\"semibold\",size:\"lg\"},void 0,\"1. \",/*#__PURE__*/_jsx(FormattedMessage,{id:\"mfa.mfa_setup_scan_title\",defaultMessage:\"Scan\"})),/*#__PURE__*/_jsx(Text,{theme:\"muted\"},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"mfa.mfa_setup_scan_description\",defaultMessage:\"Using your two-factor app, scan this QR code or enter the text key.\"}))),/*#__PURE__*/_jsx(QRCode,{value:state.qrCodeURI}),state.confirmKey,/*#__PURE__*/_jsx(Text,{weight:\"semibold\",size:\"lg\"},void 0,\"2. \",/*#__PURE__*/_jsx(FormattedMessage,{id:\"mfa.mfa_setup_verify_title\",defaultMessage:\"Verify\"})),/*#__PURE__*/_jsx(FormGroup,{labelText:intl.formatMessage(messages.codePlaceholder),hintText:/*#__PURE__*/_jsx(FormattedMessage,{id:\"mfa.mfa_setup.code_hint\",defaultMessage:\"Enter the code from your two-factor app.\"})},void 0,/*#__PURE__*/_jsx(Input,{name:\"code\",placeholder:intl.formatMessage(messages.codePlaceholder),onChange:handleInputChange,autoComplete:\"off\",disabled:state.isLoading,value:state.code,type:\"text\",required:true})),/*#__PURE__*/_jsx(FormGroup,{labelText:intl.formatMessage(messages.passwordPlaceholder),hintText:/*#__PURE__*/_jsx(FormattedMessage,{id:\"mfa.mfa_setup.password_hint\",defaultMessage:\"Enter your current password to confirm your identity.\"})},void 0,/*#__PURE__*/_jsx(Input,{type:\"password\",name:\"password\",placeholder:intl.formatMessage(messages.passwordPlaceholder),onChange:handleInputChange,disabled:state.isLoading,value:state.password,required:true})),/*#__PURE__*/_jsx(FormActions,{},void 0,/*#__PURE__*/_jsx(Button,{type:\"button\",theme:\"ghost\",text:intl.formatMessage(messages.mfaCancelButton),onClick:()=>history.push('../auth/edit'),disabled:state.isLoading}),/*#__PURE__*/_jsx(Button,{type:\"submit\",theme:\"primary\",text:intl.formatMessage(messages.mfaSetupConfirmButton),disabled:state.isLoading}))));};export default OtpConfirmForm;","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import\"core-js/modules/web.dom-collections.iterator.js\";import React,{useEffect,useState}from'react';import{useIntl,defineMessages}from'react-intl';import{fetchMfa}from'soapbox/actions/mfa';import{Card,CardBody,CardHeader,CardTitle,Column}from'soapbox/components/ui';import{useAppSelector,useAppDispatch}from'soapbox/hooks';import DisableOtpForm from'./mfa/disable_otp_form';import EnableOtpForm from'./mfa/enable_otp_form';import OtpConfirmForm from'./mfa/otp_confirm_form';/*\nSecurity settings page for user account\nRouted to /settings/mfa\nIncludes following features:\n- Set up Multi-factor Auth\n*/const messages=defineMessages({heading:{\"id\":\"column.mfa\",\"defaultMessage\":\"Multi-Factor Authentication\"}});const MfaForm=()=>{const intl=useIntl();const dispatch=useAppDispatch();const[displayOtpForm,setDisplayOtpForm]=useState(false);useEffect(()=>{dispatch(fetchMfa());},[]);const handleSetupProceedClick=event=>{event.preventDefault();setDisplayOtpForm(true);};const mfa=useAppSelector(state=>state.security.get('mfa'));return/*#__PURE__*/_jsx(Column,{label:intl.formatMessage(messages.heading),transparent:true,withHeader:false},void 0,/*#__PURE__*/_jsx(Card,{variant:\"rounded\"},void 0,/*#__PURE__*/_jsx(CardHeader,{backHref:\"/settings\"},void 0,/*#__PURE__*/_jsx(CardTitle,{title:intl.formatMessage(messages.heading)})),/*#__PURE__*/_jsx(CardBody,{},void 0,mfa.getIn(['settings','totp'])?/*#__PURE__*/_jsx(DisableOtpForm,{}):/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/_jsx(EnableOtpForm,{displayOtpForm:displayOtpForm,handleSetupProceedClick:handleSetupProceedClick}),displayOtpForm&&/*#__PURE__*/_jsx(OtpConfirmForm,{})))));};export default MfaForm;"],"names":["messages","mfa_setup_disable_button","disableFail","mfaDisableSuccess","passwordPlaceholder","useState","isLoading","setIsLoading","password","setPassword","intl","useIntl","dispatch","history","handleSubmit","useCallback","then","snackbar","formatMessage","push","finally","catch","onSubmit","weight","id","defaultMessage","theme","labelText","hintText","type","placeholder","name","onChange","event","target","value","disabled","required","text","mfaCancelButton","mfaSetupButton","codesFail","_ref","displayOtpForm","handleSetupProceedClick","backupCodes","setBackupCodes","useEffect","_ref2","space","className","align","length","map","code","i","size","onClick","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","apply","_objectSpread","arguments","source","forEach","key","getOwnPropertyDescriptors","defineProperties","defineProperty","mfaSetupConfirmButton","confirmFail","qrFail","mfaConfirmSuccess","codePlaceholder","qrCodeURI","confirmKey","state","setState","data","prevState","provisioning_uri","handleInputChange","persist","e","r","preventDefault","autoComplete","heading","setDisplayOtpForm","mfa","security","get","label","transparent","withHeader","variant","backHref","title","getIn"],"sourceRoot":""}