"use strict";(self.webpackChunkmangane_fe=self.webpackChunkmangane_fe||[]).push([[20],{544:function(e,t,a){a.r(t),a.d(t,{default:function(){return P}});var n=a(1827),o=a(0),s=a(1813),c=a(1814),r=a(1837),i=a(20),l=a(172),u=a(76),d=a(1841),f=a(1830),v=(a(1),a(5)),m=a.n(v),g=a(363),p=a(14),h=["onSelected"],Z=(0,s.vU)({placeholder:{id:"account_search.placeholder",defaultMessage:"Search for an account"}}),y=function(e){var t=e.onSelected,s=(0,f.Z)(e,h),r=(0,c.Z)(),i=(0,o.useState)(""),l=i[0],u=i[1],v=function(){return!(l.length>0)};return(0,n.Z)("div",{className:"search search--account"},void 0,(0,n.Z)("label",{},void 0,(0,n.Z)("span",{style:{display:"none"}},void 0,r.formatMessage(Z.placeholder)),o.createElement(g.Z,(0,d.Z)({className:"rounded-full",placeholder:r.formatMessage(Z.placeholder),value:l,onChange:function(e){var t=e.target;u(t.value)},onSelected:function(e){u(""),t(e)},onKeyDown:function(e){var t,a;"Escape"===e.key&&(null===(t=document.querySelector(".ui"))||void 0===t||null===(a=t.parentElement)||void 0===a||a.focus())}},s))),(0,n.Z)("div",{role:"button",tabIndex:0,className:"search__icon",onClick:function(e){e.preventDefault(),v()||u("")}},void 0,(0,n.Z)(p.Z,{src:a(183),className:m()("svg-icon--search",{active:v()})}),(0,n.Z)(p.Z,{src:a(307),className:m()("svg-icon--backspace",{active:!v()}),"aria-label":r.formatMessage(Z.placeholder)})))},x=a(53),w=a(2),b=a(3),k=a(22),M=a.n(k),N=a(1843),S=a(21),C=(a(4),a(150)),_=a(132),I=function(e){var t=e.conversationId,s=e.onMoveUp,c=e.onMoveDown,i=e.className,u=(0,b.TL)(),d=(0,r.k6)(),f=(0,b.CG)((function(e){var a=e.conversations.items.find((function(e){return e.id===t}));return{accounts:a.accounts.map((function(t){return e.accounts.get(t,null)})),unread:a.unread,lastStatus:e.statuses.get(a.last_status,null),lastStatusId:a.last_status||null}})),v=f.accounts,m=f.unread,g=f.lastStatusId,p=f.lastStatus,h=(0,o.useCallback)((function(){m&&u((0,l.v3)(t)),d.push("/statuses/".concat(g))}),[t,u,d,g,m]),Z=(0,o.useCallback)((function(){s(t)}),[t,s]),y=(0,o.useCallback)((function(){c(t)}),[t,c]),x=(0,o.useMemo)((function(){return{open:h,moveUp:Z,moveDown:y}}),[h,y,Z]);return null===g?null:(0,n.Z)(C.HotKeys,{handlers:x,"data-testid":"status"},void 0,(0,n.Z)("div",{onClick:h,role:"button",tabIndex:0,className:"bg-white dark:bg-slate-800 px-4 py-6 sm:shadow-sm dark:shadow-inset sm:p-5 sm:rounded-xl ".concat(i)},void 0,(0,n.Z)("div",{className:"flex justify-between gap-3"},void 0,(0,n.Z)("div",{className:"flex gap-2 grow"},void 0,v.map((function(e){return(0,n.Z)(_.ZP,{withLinkToProfile:!1,account:e})}))),(0,n.Z)(w.JO,{src:a(210),count:m?1:0,className:"h-6 w-6 dark:group-hover:text-primary-500"})),(0,n.Z)("div",{className:"flex justify-between mt-3 items-end gap-2"},void 0,(0,n.Z)("div",{style:{whiteSpace:"nowrap"},className:"overflow-x-hidden text-ellipsis text-gray-700 dark:text-gray-300",dangerouslySetInnerHTML:{__html:p.contentHtml.replace(/<br ?\/?>/g,"")}}),(0,n.Z)("div",{className:"text-gray-300 dark:text-gray-300 text-xs"},void 0,new Date(p.get("created_at")).toLocaleDateString(void 0,{day:"2-digit",month:"2-digit",year:"numeric"})))))},L=function(){var e=(0,b.TL)(),t=(0,o.useRef)(null),a=(0,b.CG)((function(e){return e.conversations.items})),s=(0,b.CG)((function(e){return e.conversations.isLoading})),c=function(e){return a.findIndex((function(t){return t.id===e}))},r=function(e){var t=c(e)-1;u(t)},i=function(e){var t=c(e)+1;u(t)},u=function(e){var a;null===(a=t.current)||void 0===a||a.scrollIntoView({index:e,behavior:"smooth",done:function(){var t=document.querySelector('#direct-list [data-index="'.concat(e,'"] .focusable'));t&&t.focus()}})},d=M()((function(){var t=a.getIn([-1,"id"]);t&&e((0,l.P4)({maxId:t}))}),300,{leading:!0});return o.createElement(S.Z,{onLoadMore:d,id:"direct-list",scrollKey:"direct",ref:t,isLoading:s,showLoading:s,emptyMessage:(0,n.Z)(N.Z,{id:"empty_column.direct",defaultMessage:"You don't have any direct messages yet. When you send or receive one, it will show up here."})},a.map((function(e){return(0,n.Z)(I,{className:"my-3",conversationId:e.id,onMoveUp:r,onMoveDown:i},e.id)})))},D=(0,s.vU)({title:{id:"column.direct",defaultMessage:"Conversations"},searchPlaceholder:{id:"direct.search_placeholder",defaultMessage:"Send a message toâ€¦"}}),P=function(){var e=(0,c.Z)(),t=(0,b.TL)(),a=(0,r.k6)();return(0,o.useEffect)((function(){t((0,l.ol)()),t((0,l.P4)());var e=t((0,u._o)());return function(){t((0,l.eC)()),e()}}),[t]),(0,n.Z)(w.sg,{label:e.formatMessage(D.title),transparent:!0,withHeader:!1},void 0,(0,n.Z)("div",{className:"px-4 pt-4 pb-8 sm:px-0 sm:pt-0"},void 0,(0,n.Z)(x.Z,{message:e.formatMessage(D.title)}),(0,n.Z)("div",{className:"flex flex-col gap-3"},void 0,(0,n.Z)(y,{placeholder:e.formatMessage(D.searchPlaceholder),onSelected:function(e){t((0,i.W3)(a,e))}}),(0,n.Z)(L,{}))))}}}]);
//# sourceMappingURL=conversations-6c523e813cfe98010ae7.chunk.js.map