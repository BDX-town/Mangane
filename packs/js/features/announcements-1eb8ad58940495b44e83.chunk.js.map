{"version":3,"file":"packs/js/features/announcements-1eb8ad58940495b44e83.chunk.js","mappings":"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","sources":["webpack://mangane-fe/./app/soapbox/components/announcements/announcement-content.tsx","webpack://mangane-fe/./app/soapbox/components/animated-number.tsx","webpack://mangane-fe/./app/soapbox/components/announcements/emoji.tsx","webpack://mangane-fe/./app/soapbox/components/announcements/reaction.tsx","webpack://mangane-fe/./app/soapbox/components/announcements/reactions-bar.tsx","webpack://mangane-fe/./app/soapbox/components/announcements/announcement.tsx","webpack://mangane-fe/./app/soapbox/components/announcements/announcements-panel.tsx"],"sourcesContent":["import\"core-js/modules/es.string.replace.js\";import React,{useEffect,useRef}from'react';import{useHistory}from'react-router-dom';const AnnouncementContent=_ref=>{let{announcement}=_ref;const history=useHistory();const node=useRef(null);useEffect(()=>{updateLinks();});const onMentionClick=(mention,e)=>{if(e.button===0&&!(e.ctrlKey||e.metaKey)){e.preventDefault();e.stopPropagation();history.push(\"/@\".concat(mention.acct));}};const onHashtagClick=(hashtag,e)=>{hashtag=hashtag.replace(/^#/,'').toLowerCase();if(e.button===0&&!(e.ctrlKey||e.metaKey)){e.preventDefault();e.stopPropagation();history.push(\"/tag/\".concat(hashtag));}};const onStatusClick=(status,e)=>{if(e.button===0&&!(e.ctrlKey||e.metaKey)){e.preventDefault();history.push(status);}};const updateLinks=()=>{if(!node.current)return;const links=node.current.querySelectorAll('a');links.forEach(link=>{var _link$textContent,_link$previousSibling,_link$previousSibling2;// Skip already processed\nif(link.classList.contains('status-link'))return;// Add attributes\nlink.classList.add('status-link');link.setAttribute('rel','nofollow noopener');link.setAttribute('target','_blank');const mention=announcement.mentions.find(mention=>link.href===\"\".concat(mention.url));// Add event listeners on mentions, hashtags and statuses\nif(mention){link.addEventListener('click',onMentionClick.bind(link,mention),false);link.setAttribute('title',mention.acct);}else if(((_link$textContent=link.textContent)===null||_link$textContent===void 0?void 0:_link$textContent.charAt(0))==='#'||((_link$previousSibling=link.previousSibling)===null||_link$previousSibling===void 0?void 0:(_link$previousSibling2=_link$previousSibling.textContent)===null||_link$previousSibling2===void 0?void 0:_link$previousSibling2.charAt(link.previousSibling.textContent.length-1))==='#'){link.addEventListener('click',onHashtagClick.bind(link,link.text),false);}else{const status=announcement.statuses.get(link.href);if(status){link.addEventListener('click',onStatusClick.bind(this,status),false);}link.setAttribute('title',link.href);link.classList.add('unhandled-link');}});};return/*#__PURE__*/React.createElement(\"div\",{className:\"translate text-sm\",ref:node,dangerouslySetInnerHTML:{__html:announcement.contentHtml}});};export default AnnouncementContent;","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import\"core-js/modules/web.dom-collections.iterator.js\";import React,{useEffect,useState}from'react';import{FormattedNumber}from'react-intl';import{TransitionMotion,spring}from'react-motion';import{useSettings}from'soapbox/hooks';const obfuscatedCount=count=>{if(count<0){return 0;}else if(count<=1){return count;}else{return'1+';}};const AnimatedNumber=_ref=>{let{value,obfuscate}=_ref;const reduceMotion=useSettings().get('reduceMotion');const[direction,setDirection]=useState(1);const[displayedValue,setDisplayedValue]=useState(value);useEffect(()=>{if(displayedValue!==undefined){if(value>displayedValue)setDirection(1);else if(value<displayedValue)setDirection(-1);}setDisplayedValue(value);},[value]);const willEnter=()=>({y:-1*direction});const willLeave=()=>({y:spring(1*direction,{damping:35,stiffness:400})});if(reduceMotion){return obfuscate?/*#__PURE__*/React.createElement(React.Fragment,null,obfuscatedCount(displayedValue)):/*#__PURE__*/_jsx(FormattedNumber,{value:displayedValue});}const styles=[{key:\"\".concat(displayedValue),data:displayedValue,style:{y:spring(0,{damping:35,stiffness:400})}}];return/*#__PURE__*/_jsx(TransitionMotion,{styles:styles,willEnter:willEnter,willLeave:willLeave},void 0,items=>/*#__PURE__*/_jsx(\"span\",{className:\"inline-flex flex-col items-stretch relative overflow-hidden\"},void 0,items.map(_ref2=>{let{key,data,style}=_ref2;return/*#__PURE__*/_jsx(\"span\",{style:{position:direction*style.y>0?'absolute':'static',transform:\"translateY(\".concat(style.y*100,\"%)\")}},key,obfuscate?obfuscatedCount(data):/*#__PURE__*/_jsx(FormattedNumber,{value:data}));})));};export default AnimatedNumber;","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import React from'react';import unicodeMapping from'soapbox/features/emoji/emoji_unicode_mapping_light';import{useSettings}from'soapbox/hooks';import{joinPublicPath}from'soapbox/utils/static';const Emoji=_ref=>{let{emoji,emojiMap,hovered}=_ref;const autoPlayGif=useSettings().get('autoPlayGif');// @ts-ignore\nif(unicodeMapping[emoji]){// @ts-ignore\nconst{filename,shortCode}=unicodeMapping[emoji];const title=shortCode?\":\".concat(shortCode,\":\"):'';return/*#__PURE__*/_jsx(\"img\",{draggable:\"false\",className:\"emojione block m-0\",alt:emoji,title:title,src:joinPublicPath(\"packs/emoji/\".concat(filename,\".svg\"))});}else if(emojiMap.get(emoji)){const filename=autoPlayGif||hovered?emojiMap.getIn([emoji,'url']):emojiMap.getIn([emoji,'static_url']);const shortCode=\":\".concat(emoji,\":\");return/*#__PURE__*/_jsx(\"img\",{draggable:\"false\",className:\"emojione block m-0\",alt:shortCode,title:shortCode,src:filename});}else{return null;}};export default Emoji;","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import\"core-js/modules/web.dom-collections.iterator.js\";import classNames from'classnames';import React,{useState}from'react';import AnimatedNumber from'soapbox/components/animated-number';import unicodeMapping from'soapbox/features/emoji/emoji_unicode_mapping_light';import Emoji from'./emoji';const Reaction=_ref=>{let{announcementId,reaction,addReaction,removeReaction,emojiMap,style}=_ref;const[hovered,setHovered]=useState(false);const handleClick=()=>{if(reaction.me){removeReaction(announcementId,reaction.name);}else{addReaction(announcementId,reaction.name);}};const handleMouseEnter=()=>setHovered(true);const handleMouseLeave=()=>setHovered(false);let shortCode=reaction.name;// @ts-ignore\nif(unicodeMapping[shortCode]){// @ts-ignore\nshortCode=unicodeMapping[shortCode].shortCode;}return/*#__PURE__*/_jsx(\"button\",{className:classNames('flex shrink-0 items-center gap-1.5 bg-gray-100 dark:bg-primary-900 rounded-sm px-1.5 py-1 transition-colors',{'bg-gray-200 dark:bg-primary-800':hovered,'bg-primary-200 dark:bg-primary-500':reaction.me}),onClick:handleClick,onMouseEnter:handleMouseEnter,onMouseLeave:handleMouseLeave,title:\":\".concat(shortCode,\":\"),style:style},void 0,/*#__PURE__*/_jsx(\"span\",{className:\"block h-4 w-4\"},void 0,/*#__PURE__*/_jsx(Emoji,{hovered:hovered,emoji:reaction.name,emojiMap:emojiMap})),/*#__PURE__*/_jsx(\"span\",{className:\"block min-w-[9px] text-center text-xs font-medium text-primary-600 dark:text-white\"},void 0,/*#__PURE__*/_jsx(AnimatedNumber,{value:reaction.count})));};export default Reaction;","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import\"core-js/modules/es.string.replace.js\";import classNames from'classnames';import React from'react';import{TransitionMotion,spring}from'react-motion';import{Icon}from'soapbox/components/ui';import EmojiPickerDropdown from'soapbox/containers/emoji_picker_dropdown_container';import{useSettings}from'soapbox/hooks';import Reaction from'./reaction';const ReactionsBar=_ref=>{let{announcementId,reactions,addReaction,removeReaction,emojiMap}=_ref;const reduceMotion=useSettings().get('reduceMotion');const handleEmojiPick=data=>{addReaction(announcementId,data.native.replace(/:/g,''));};const willEnter=()=>({scale:reduceMotion?1:0});const willLeave=()=>({scale:reduceMotion?0:spring(0,{stiffness:170,damping:26})});const visibleReactions=reactions.filter(x=>x.count>0);const styles=visibleReactions.map(reaction=>({key:reaction.name,data:reaction,style:{scale:reduceMotion?1:spring(1,{stiffness:150,damping:13})}})).toArray();return/*#__PURE__*/_jsx(TransitionMotion,{styles:styles,willEnter:willEnter,willLeave:willLeave},void 0,items=>/*#__PURE__*/_jsx(\"div\",{className:classNames('flex flex-wrap items-center gap-1',{'reactions-bar--empty':visibleReactions.isEmpty()})},void 0,items.map(_ref2=>{let{key,data,style}=_ref2;return/*#__PURE__*/_jsx(Reaction,{reaction:data,style:{transform:\"scale(\".concat(style.scale,\")\"),position:style.scale<0.5?'absolute':'static'},announcementId:announcementId,addReaction:addReaction,removeReaction:removeReaction,emojiMap:emojiMap},key);}),visibleReactions.size<8&&/*#__PURE__*/_jsx(EmojiPickerDropdown,{onPickEmoji:handleEmojiPick,button:/*#__PURE__*/_jsx(Icon,{className:\"h-4 w-4 text-gray-400 hover:text-gray-600 dark:hover:text-white\",src:require('@tabler/icons/plus.svg')})})));};export default ReactionsBar;","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import React from'react';import{FormattedDate}from'react-intl';import{Stack,Text}from'soapbox/components/ui';import{useFeatures}from'soapbox/hooks';import AnnouncementContent from'./announcement-content';import ReactionsBar from'./reactions-bar';const Announcement=_ref=>{let{announcement,addReaction,removeReaction,emojiMap}=_ref;const features=useFeatures();const startsAt=announcement.starts_at&&new Date(announcement.starts_at);const endsAt=announcement.ends_at&&new Date(announcement.ends_at);const now=new Date();const hasTimeRange=startsAt&&endsAt;const skipYear=hasTimeRange&&startsAt.getFullYear()===endsAt.getFullYear()&&endsAt.getFullYear()===now.getFullYear();const skipEndDate=hasTimeRange&&startsAt.getDate()===endsAt.getDate()&&startsAt.getMonth()===endsAt.getMonth()&&startsAt.getFullYear()===endsAt.getFullYear();const skipTime=announcement.all_day;return/*#__PURE__*/_jsx(Stack,{className:\"w-full\",space:2},void 0,hasTimeRange&&/*#__PURE__*/_jsx(Text,{theme:\"muted\"},void 0,/*#__PURE__*/_jsx(FormattedDate,{value:startsAt,hour12:false,year:skipYear||startsAt.getFullYear()===now.getFullYear()?undefined:'numeric',month:\"short\",day:\"2-digit\",hour:skipTime?undefined:'2-digit',minute:skipTime?undefined:'2-digit'}),' ',\"-\",' ',/*#__PURE__*/_jsx(FormattedDate,{value:endsAt,hour12:false,year:skipYear||endsAt.getFullYear()===now.getFullYear()?undefined:'numeric',month:skipEndDate?undefined:'short',day:skipEndDate?undefined:'2-digit',hour:skipTime?undefined:'2-digit',minute:skipTime?undefined:'2-digit'})),/*#__PURE__*/_jsx(AnnouncementContent,{announcement:announcement}),features.announcementsReactions&&/*#__PURE__*/_jsx(ReactionsBar,{reactions:announcement.reactions,announcementId:announcement.id,addReaction:addReaction,removeReaction:removeReaction,emojiMap:emojiMap}));};export default Announcement;","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import\"core-js/modules/web.dom-collections.iterator.js\";import classNames from'classnames';import{Map as ImmutableMap}from'immutable';import React,{useState}from'react';import{FormattedMessage}from'react-intl';import ReactSwipeableViews from'react-swipeable-views';import{createSelector}from'reselect';import{addReaction as addReactionAction,removeReaction as removeReactionAction}from'soapbox/actions/announcements';import{Card,HStack,Widget}from'soapbox/components/ui';import{useAppDispatch,useAppSelector}from'soapbox/hooks';import Announcement from'./announcement';const customEmojiMap=createSelector([state=>state.custom_emojis],items=>items.reduce((map,emoji)=>map.set(emoji.get('shortcode'),emoji),ImmutableMap()));const AnnouncementsPanel=()=>{const dispatch=useAppDispatch();const emojiMap=useAppSelector(state=>customEmojiMap(state));const[index,setIndex]=useState(0);const announcements=useAppSelector(state=>state.announcements.items);const addReaction=(id,name)=>dispatch(addReactionAction(id,name));const removeReaction=(id,name)=>dispatch(removeReactionAction(id,name));if(announcements.size===0)return null;const handleChangeIndex=index=>{setIndex(index%announcements.size);};return/*#__PURE__*/_jsx(Widget,{title:/*#__PURE__*/_jsx(FormattedMessage,{id:\"announcements.title\",defaultMessage:\"Announcements\"})},void 0,/*#__PURE__*/_jsx(Card,{className:\"relative\",size:\"md\",variant:\"rounded\"},void 0,/*#__PURE__*/_jsx(ReactSwipeableViews,{animateHeight:true,index:index,onChangeIndex:handleChangeIndex},void 0,announcements.map(announcement=>/*#__PURE__*/_jsx(Announcement,{announcement:announcement,emojiMap:emojiMap,addReaction:addReaction,removeReaction:removeReaction},announcement.id)).reverse()),announcements.size>1&&/*#__PURE__*/_jsx(HStack,{space:2,alignItems:\"center\",justifyContent:\"center\",className:\"relative\"},void 0,announcements.map((_,i)=>/*#__PURE__*/_jsx(\"button\",{tabIndex:0,onClick:()=>setIndex(i),className:classNames({'w-2 h-2 rounded-full focus:ring-primary-600 focus:ring-2 focus:ring-offset-2':true,'bg-gray-200 hover:bg-gray-300':i!==index,'bg-primary-600':i===index})},i)))));};export default AnnouncementsPanel;"],"names":["_ref","announcement","history","node","useRef","useEffect","updateLinks","onMentionClick","mention","e","button","ctrlKey","metaKey","preventDefault","stopPropagation","push","concat","acct","onHashtagClick","hashtag","replace","toLowerCase","onStatusClick","status","current","querySelectorAll","forEach","link","_link$textContent","_link$previousSibling","_link$previousSibling2","classList","contains","add","setAttribute","mentions","find","href","url","addEventListener","bind","textContent","charAt","previousSibling","length","text","statuses","get","className","ref","dangerouslySetInnerHTML","__html","contentHtml","obfuscatedCount","count","value","obfuscate","reduceMotion","useState","direction","setDirection","displayedValue","setDisplayedValue","undefined","styles","key","data","style","y","damping","stiffness","willEnter","willLeave","items","map","_ref2","position","transform","emoji","emojiMap","hovered","autoPlayGif","filename","title","shortCode","draggable","alt","src","getIn","announcementId","reaction","addReaction","removeReaction","setHovered","name","me","onClick","onMouseEnter","onMouseLeave","reactions","handleEmojiPick","native","visibleReactions","filter","x","scale","toArray","isEmpty","size","onPickEmoji","features","startsAt","starts_at","Date","endsAt","ends_at","now","hasTimeRange","skipYear","getFullYear","skipEndDate","getDate","getMonth","skipTime","all_day","space","theme","hour12","year","month","day","hour","minute","announcementsReactions","id","customEmojiMap","state","custom_emojis","reduce","set","dispatch","index","setIndex","announcements","defaultMessage","variant","animateHeight","onChangeIndex","reverse","alignItems","justifyContent","_","i","tabIndex"],"sourceRoot":""}