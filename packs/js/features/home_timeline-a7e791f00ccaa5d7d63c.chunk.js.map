{"version":3,"file":"packs/js/features/home_timeline-a7e791f00ccaa5d7d63c.chunk.js","mappings":"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","sources":["webpack://mangane-fe/./app/soapbox/features/home_timeline/index.tsx"],"sourcesContent":["var _jsxFileName = \"/home/runner/work/Mangane/Mangane/app/soapbox/features/home_timeline/index.tsx\";\nimport React, { useEffect, useRef } from 'react';\nimport { defineMessages, useIntl, FormattedMessage } from 'react-intl';\nimport { Link } from 'react-router-dom';\nimport { fetchRelationships } from 'soapbox/actions/accounts';\nimport { fetchSuggestionsForTimeline } from 'soapbox/actions/suggestions';\nimport { expandHomeTimeline } from 'soapbox/actions/timelines';\nimport PullToRefresh from 'soapbox/components/pull-to-refresh';\nimport { Column, Stack, Text } from 'soapbox/components/ui';\nimport Timeline from 'soapbox/features/ui/components/timeline';\nimport { useAppSelector, useAppDispatch, useFeatures } from 'soapbox/hooks';\nimport { clearFeedAccountId } from '../../actions/timelines';\nconst messages = defineMessages({\n  title: {\n    \"id\": \"column.home\",\n    \"defaultMessage\": \"Home\"\n  }\n});\n\nconst HomeTimeline = () => {\n  const intl = useIntl();\n  const dispatch = useAppDispatch();\n  const features = useFeatures();\n  const polling = useRef(null);\n  const isPartial = useAppSelector(state => {\n    var _state$timelines$get;\n\n    return ((_state$timelines$get = state.timelines.get('home')) === null || _state$timelines$get === void 0 ? void 0 : _state$timelines$get.isPartial) === true;\n  });\n  const currentAccountId = useAppSelector(state => {\n    var _state$timelines$get2;\n\n    return (_state$timelines$get2 = state.timelines.get('home')) === null || _state$timelines$get2 === void 0 ? void 0 : _state$timelines$get2.feedAccountId;\n  });\n  const siteTitle = useAppSelector(state => state.instance.title);\n  const currentAccountRelationship = useAppSelector(state => currentAccountId ? state.relationships.get(currentAccountId) : null);\n\n  const handleLoadMore = maxId => {\n    dispatch(expandHomeTimeline({\n      maxId,\n      accountId: currentAccountId\n    }));\n  }; // Mastodon generates the feed in Redis, and can return a partial timeline\n  // (HTTP 206) for new users. Poll until we get a full page of results.\n\n\n  const checkIfReloadNeeded = () => {\n    if (isPartial) {\n      polling.current = setInterval(() => {\n        dispatch(expandHomeTimeline());\n      }, 3000);\n    } else {\n      stopPolling();\n    }\n  };\n\n  const stopPolling = () => {\n    if (polling.current) {\n      clearInterval(polling.current);\n      polling.current = null;\n    }\n  };\n\n  const handleRefresh = () => {\n    return dispatch(expandHomeTimeline({\n      maxId: null,\n      accountId: currentAccountId\n    }));\n  };\n\n  useEffect(() => {\n    checkIfReloadNeeded();\n    return () => {\n      stopPolling();\n    };\n  }, [isPartial]);\n  useEffect(() => {\n    // Check to see if we still follow the user that is selected in the Feed Carousel.\n    if (currentAccountId) {\n      dispatch(fetchRelationships([currentAccountId]));\n    }\n  }, []);\n  useEffect(() => {\n    // If we unfollowed the currently selected user from the Feed Carousel,\n    // let's clear the feed filter and refetch fresh timeline data.\n    if (currentAccountRelationship && !(currentAccountRelationship !== null && currentAccountRelationship !== void 0 && currentAccountRelationship.following)) {\n      dispatch(clearFeedAccountId());\n      dispatch(expandHomeTimeline({}, () => {\n        dispatch(fetchSuggestionsForTimeline());\n      }));\n    }\n  }, [currentAccountId]);\n  return /*#__PURE__*/React.createElement(Column, {\n    label: intl.formatMessage(messages.title),\n    transparent: true,\n    withHeader: false,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(PullToRefresh, {\n    onRefresh: handleRefresh,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Timeline, {\n    scrollKey: \"home_timeline\",\n    onLoadMore: handleLoadMore,\n    timelineId: \"home\",\n    divideType: \"space\",\n    showAds: true,\n    emptyMessage: /*#__PURE__*/React.createElement(Stack, {\n      space: 1,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Text, {\n      size: \"xl\",\n      weight: \"medium\",\n      align: \"center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(FormattedMessage, {\n      id: \"empty_column.home.title\",\n      defaultMessage: \"You're not following anyone yet\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 17\n      }\n    })), /*#__PURE__*/React.createElement(Text, {\n      theme: \"muted\",\n      align: \"center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(FormattedMessage, {\n      id: \"empty_column.home.subtitle\",\n      defaultMessage: \"{siteTitle} gets more interesting once you follow other users.\",\n      values: {\n        siteTitle\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 17\n      }\n    })), features.federating && /*#__PURE__*/React.createElement(Text, {\n      theme: \"muted\",\n      align: \"center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(FormattedMessage, {\n      id: \"empty_column.home\",\n      defaultMessage: \"Or you can visit {public} to get started and meet other users.\",\n      values: {\n        public: /*#__PURE__*/React.createElement(Link, {\n          to: \"/timeline/local\",\n          className: \"text-primary-600 dark:text-primary-400 hover:underline\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 118,\n            columnNumber: 25\n          }\n        }, /*#__PURE__*/React.createElement(FormattedMessage, {\n          id: \"empty_column.home.local_tab\",\n          defaultMessage: \"the {site_title} tab\",\n          values: {\n            site_title: siteTitle\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 27\n          }\n        }))\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 19\n      }\n    }))),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 9\n    }\n  })));\n};\n\nexport default HomeTimeline;"],"names":[],"sourceRoot":""}