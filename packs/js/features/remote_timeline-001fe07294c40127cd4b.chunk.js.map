{"version":3,"file":"packs/js/features/remote_timeline-001fe07294c40127cd4b.chunk.js","mappings":"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","sources":["webpack://mangane-fe/./app/soapbox/features/remote_timeline/index.tsx","webpack://mangane-fe/./app/soapbox/features/ui/components/instance_info_panel.tsx","webpack://mangane-fe/./app/soapbox/features/ui/components/instance_moderation_panel.tsx"],"sourcesContent":["import _jsx from\"@babel/runtime/helpers/esm/jsx\";import\"core-js/modules/web.dom-collections.iterator.js\";import React,{useEffect,useRef,useState}from'react';import{defineMessages,FormattedMessage,useIntl}from'react-intl';import{connectRemoteStream}from'soapbox/actions/streaming';import{expandRemoteTimeline}from'soapbox/actions/timelines';import SubNavigation from'soapbox/components/sub_navigation';import TimelineSettings from'soapbox/components/timeline_settings';import{IconButton}from'soapbox/components/ui';import Column from'soapbox/features/ui/components/column';import{useAppDispatch,useAppSelector,useSettings}from'soapbox/hooks';import{isMobile}from'soapbox/is_mobile';import{makeGetRemoteInstance}from'soapbox/selectors';import Timeline from'../ui/components/timeline';import{ButtonPin}from'./components/button-pin';const messages=defineMessages({settings:{\"id\":\"settings.settings\",\"defaultMessage\":\"Settings\"}});const Heading=_ref=>{let{instance}=_ref;const getRemoteInstance=makeGetRemoteInstance();const meta=useAppSelector(s=>getRemoteInstance(s,instance));return/*#__PURE__*/_jsx(\"div\",{className:\"flex gap-2 items-center\"},void 0,meta.get('favicon')&&/*#__PURE__*/_jsx(\"img\",{alt:\"\".concat(instance,\" favicon\"),src:meta.get('favicon'),width:24,height:24}),instance,/*#__PURE__*/_jsx(ButtonPin,{instance:instance,width:20,height:20}));};/** View statuses from a remote instance. */const RemoteTimeline=_ref2=>{let{params}=_ref2;const intl=useIntl();const dispatch=useAppDispatch();const instance=params===null||params===void 0?void 0:params.instance;const stream=useRef(null);const timelineId=\"remote:\".concat(instance);const[showSettings,setShowSettings]=useState(false);const settings=useSettings();const onlyMedia=settings.getIn([timelineId,'other','onlyMedia']);const excludeReplies=settings.getIn([timelineId,'shows','reply']);const disconnect=()=>{if(stream.current){stream.current();}};const handleLoadMore=maxId=>{dispatch(expandRemoteTimeline(instance,{maxId,onlyMedia,excludeReplies}));};useEffect(()=>{disconnect();dispatch(expandRemoteTimeline(instance,{onlyMedia,maxId:undefined,excludeReplies}));if(!isMobile(window.innerWidth)){stream.current=dispatch(connectRemoteStream(instance,{onlyMedia,excludeReplies}));return()=>{disconnect();stream.current=null;};}},[dispatch,excludeReplies,instance,onlyMedia]);return/*#__PURE__*/_jsx(\"div\",{className:\"pt-3\"},void 0,/*#__PURE__*/_jsx(Column,{label:instance,transparent:true,withHeader:false},void 0,/*#__PURE__*/_jsx(\"div\",{className:\"px-4 pt-4 sm:p-0 flex justify-between\"},void 0,/*#__PURE__*/_jsx(SubNavigation,{},void 0,/*#__PURE__*/_jsx(Heading,{instance:instance})),/*#__PURE__*/_jsx(IconButton,{src:!showSettings?require('@tabler/icons/chevron-down.svg'):require('@tabler/icons/chevron-up.svg'),onClick:()=>setShowSettings(!showSettings),title:intl.formatMessage(messages.settings)})),showSettings&&/*#__PURE__*/_jsx(TimelineSettings,{className:\"mb-3\",timeline:timelineId,onClose:()=>setShowSettings(false)}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 px-4 sm:p-0\"},void 0,instance&&/*#__PURE__*/_jsx(FormattedMessage,{id:\"remote_timeline.filter_message\",defaultMessage:\"You are viewing the local timeline of {instance}.\",values:{instance}})),/*#__PURE__*/_jsx(Timeline,{scrollKey:\"\".concat(timelineId,\"_timeline\"),timelineId:\"\".concat(timelineId).concat(onlyMedia?':media':'').concat(excludeReplies?':exclude_replies':''),onLoadMore:handleLoadMore,emptyMessage:/*#__PURE__*/_jsx(FormattedMessage,{id:\"empty_column.remote\",defaultMessage:\"There is nothing here! Manually follow users from {instance} to fill it up.\",values:{instance}}),divideType:\"space\"})));};export default RemoteTimeline;","'use strict';import _jsx from\"@babel/runtime/helpers/esm/jsx\";import\"core-js/modules/es.array.includes.js\";import React from'react';import{useIntl,defineMessages}from'react-intl';import{pinHost,unpinHost}from'soapbox/actions/remote_timeline';import{Widget}from'soapbox/components/ui';import{useAppSelector,useAppDispatch,useSettings}from'soapbox/hooks';import{makeGetRemoteInstance}from'soapbox/selectors';const getRemoteInstance=makeGetRemoteInstance();const messages=defineMessages({pinHost:{\"id\":\"remote_instance.pin_host\",\"defaultMessage\":\"Pin {host}\"},unpinHost:{\"id\":\"remote_instance.unpin_host\",\"defaultMessage\":\"Unpin {host}\"}});/** Widget that displays information about a remote instance to users. */const InstanceInfoPanel=_ref=>{let{host}=_ref;const intl=useIntl();const dispatch=useAppDispatch();const settings=useSettings();const remoteInstance=useAppSelector(state=>getRemoteInstance(state,host));const pinned=settings.getIn(['remote_timeline','pinnedHosts']).includes(host);const handlePinHost=()=>{if(!pinned){dispatch(pinHost(host));}else{dispatch(unpinHost(host));}};if(!remoteInstance)return null;return/*#__PURE__*/_jsx(Widget,{title:remoteInstance.get('host'),onActionClick:handlePinHost,actionIcon:pinned?require('@tabler/icons/pinned-off.svg'):require('@tabler/icons/pin.svg'),actionTitle:intl.formatMessage(pinned?messages.unpinHost:messages.pinHost,{host})});};export default InstanceInfoPanel;","'use strict';import _jsx from\"@babel/runtime/helpers/esm/jsx\";import React from'react';import{useIntl,defineMessages,FormattedMessage}from'react-intl';import{openModal}from'soapbox/actions/modals';import{Widget}from'soapbox/components/ui';import DropdownMenu from'soapbox/containers/dropdown_menu_container';import InstanceRestrictions from'soapbox/features/federation_restrictions/components/instance_restrictions';import{useAppSelector,useAppDispatch,useOwnAccount}from'soapbox/hooks';import{makeGetRemoteInstance}from'soapbox/selectors';const getRemoteInstance=makeGetRemoteInstance();const messages=defineMessages({editFederation:{\"id\":\"remote_instance.edit_federation\",\"defaultMessage\":\"Edit federation\"}});/** Widget for moderators to manage a remote instance. */const InstanceModerationPanel=_ref=>{let{host}=_ref;const intl=useIntl();const dispatch=useAppDispatch();const account=useOwnAccount();const remoteInstance=useAppSelector(state=>getRemoteInstance(state,host));const handleEditFederation=()=>{dispatch(openModal('EDIT_FEDERATION',{host}));};const makeMenu=()=>{return[{text:intl.formatMessage(messages.editFederation),action:handleEditFederation,icon:require('@tabler/icons/edit.svg')}];};const menu=makeMenu();return/*#__PURE__*/_jsx(Widget,{title:/*#__PURE__*/_jsx(FormattedMessage,{id:\"remote_instance.federation_panel.heading\",defaultMessage:\"Federation Restrictions\"}),action:account!==null&&account!==void 0&&account.admin?/*#__PURE__*/_jsx(DropdownMenu,{items:menu,src:require('@tabler/icons/dots-vertical.svg')}):undefined},void 0,/*#__PURE__*/_jsx(InstanceRestrictions,{remoteInstance:remoteInstance}));};export default InstanceModerationPanel;"],"names":["messages","settings","Heading","_ref","instance","getRemoteInstance","meta","s","className","get","alt","concat","src","width","height","_ref2","params","intl","dispatch","stream","useRef","timelineId","useState","showSettings","setShowSettings","onlyMedia","getIn","excludeReplies","disconnect","current","useEffect","maxId","undefined","window","innerWidth","label","transparent","withHeader","onClick","title","formatMessage","timeline","onClose","id","defaultMessage","values","scrollKey","onLoadMore","emptyMessage","divideType","pinHost","unpinHost","host","remoteInstance","state","pinned","includes","onActionClick","actionIcon","actionTitle","editFederation","account","menu","text","action","icon","admin","items"],"sourceRoot":""}