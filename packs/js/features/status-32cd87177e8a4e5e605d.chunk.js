"use strict";(self.webpackChunkmangane_fe=self.webpackChunkmangane_fe||[]).push([[70],{1133:function(e,t,n){n.r(t),n.d(t,{default:function(){return $}});var a=n(1840),s=n(22),i=n.n(s),o=(n(7),n(2),n(4),n(595),n(5)),r=n.n(o),u=n(321),l=n(0),c=n(201),d=n(1826),f=n(1827),m=n(1850),v=n(45),g=n(19),p=n(62),h=n(1842),Z=n(16),b=n(49),y=n(63),x=n(104),_=n(20),M=n(719),w=function(e){var t=e.className,n=e.stickyClassName,a=e.children,s=l.useRef(),i=l.useRef(),o=l.useState(!1),r=o[0],u=o[1],c=l.useCallback((function(e){e.find((function(e){return 0==e.isIntersecting}))?u(!0):u(!1)}),[]);return l.useEffect((function(){var e=new IntersectionObserver(c,{threshold:[0,1]});return e.observe(s.current),function(){e.disconnect()}}),[c]),l.createElement(l.Fragment,null,l.createElement("div",{ref:s,className:t},a),r&&l.createElement("div",{ref:i,className:"component-sticky__fixed fixed top-0 z-50 ".concat(n)},a))},N=n(69),k=n(1856),I=n(1),S=function(e){var t=e.id,n=e.onMoveUp,s=e.onMoveDown,i={moveUp:function(){return n(t)},moveDown:function(){return s(t)}};return(0,a.Z)(c.HotKeys,{handlers:i},void 0,(0,a.Z)("div",{className:"p-9 flex items-center justify-center sm:rounded-xl bg-gray-100 border border-solid border-gray-200 dark:bg-slate-900 dark:border-slate-700 focusable",tabIndex:0},void 0,(0,a.Z)(I.xv,{},void 0,(0,a.Z)(k.Z,{id:"statuses.tombstone",defaultMessage:"One or more posts are unavailable."}))))},C=n(282),E=n(720),T=n(3),O=n(9),R=n(1844),z=n(14),D=n(693),j=n(301),U=n(134),A=n(23),G=n(393),q=n(15),H=n(6),K=n(269),L=function(e){var t=e.status,s=(0,T.CG)((function(e){return e.me})),i=(0,H.I0)(),o=(0,T.hz)(),c=t.account,f=function(){i((0,h.h7)("UNAUTHORIZED"))},m=l.useCallback((function(){return(0,K.Rj)((0,u.List)(t.pleroma.get("emoji_reactions")),t.favourites_count,t.favourited,null).reverse()}),[t]);if(!c||"object"!=typeof c)return null;var v,g;return(0,a.Z)(I.Ug,{space:3},void 0,o.emojiReacts?(g=(v=m()).reduce((function(e,t){return e+t.get("count")}),0))>0?(0,a.Z)(I.Ug,{space:.5,className:"emoji-reacts-container",alignItems:"center"},void 0,(0,a.Z)("div",{className:"emoji-reacts"},void 0,v.map((function(e,n){return(0,a.Z)(I.Ug,{space:.5,className:"emoji-react p-1",alignItems:"center"},n,(0,a.Z)(I.SF,{className:r()("emoji-react__emoji w-5 h-5 flex-none",{"cursor-pointer":o.exposableReactions}),emoji:e,onClick:o.exposableReactions?(u=e,function(){s?function(e,t,n){i((0,h.h7)("REACTIONS",{username:e,statusId:t,reaction:n}))}(c.acct,t.id,String(u.get("name"))):f()}):void 0}),(0,a.Z)(I.xv,{theme:"muted",size:"sm",className:"emoji-react__count"},void 0,(0,a.Z)(d.BK,{value:e.get("count")})));var u}))),(0,a.Z)(I.xv,{theme:"muted",size:"sm",className:"emoji-reacts__count"},void 0,(0,a.Z)(d.BK,{value:g}))):"":t.favourites_count?(0,a.Z)(I.Ug,{space:.5,alignItems:"center"},void 0,(0,a.Z)(I.hU,{className:r()({"text-accent-300":!0,"cursor-default":!o.exposableReactions}),src:n(211),iconClassName:"fill-accent-300",role:"presentation",onClick:o.exposableReactions?function(e){var n,a;e.preventDefault(),s?(n=c.acct,a=t.id,i((0,h.h7)("FAVOURITES",{username:n,statusId:a}))):f()}:void 0}),(0,a.Z)(I.xv,{theme:"muted",size:"sm"},void 0,(0,a.Z)(d.BK,{value:t.favourites_count}))):"",t.reblogs_count?(0,a.Z)(I.Ug,{space:.5,alignItems:"center"},void 0,(0,a.Z)(I.hU,{className:"text-success-600 cursor-pointer",src:n(103),role:"presentation",onClick:function(e){var n,a;e.preventDefault(),s?(n=c.acct,a=t.id,i((0,h.h7)("REBLOGS",{username:n,statusId:a}))):f()}}),(0,a.Z)(I.xv,{theme:"muted",size:"sm"},void 0,(0,a.Z)(d.BK,{value:t.reblogs_count}))):"")},B=function(e){var t,s=e.status,i=e.onToggleHidden,o=e.onOpenCompareHistoryModal,r=e.onToggleMediaVisibility,u=e.onTranslate,c=e.showMedia,m=(0,f.Z)(),v=(0,l.useRef)(null),g=(0,T.Tr)(),p=(0,T.CG)((function(e){return(0,Z.Gw)(e).get("locale")})),h=l.useMemo((function(){return new Intl.DisplayNames([p],{type:"language"}).of(p)}),[p]),b=(0,T.CG)((function(e){return(0,q.N$)(e.instance)})),y=(0,T.uP)(),x=(0,R.d4)(s),_=x.account,M=l.useMemo((function(){return g&&b.translations&&x.language!==p}),[g,b,x]),w=l.useCallback((function(){u(s,p)}),[s,p]),N=l.useMemo((function(){switch(null==x?void 0:x.visibility){default:return n(117);case"unlisted":return n(99);case"local":return y;case"private":return n(118);case"direct":return n(85)}}),[null==x?void 0:x.visibility]);return x&&_&&"object"==typeof _?(x.quote&&(t=!1===x.pleroma.get("quote_visible",!0)?(0,a.Z)("div",{className:"quoted-actualStatus-tombstone"},void 0,(0,a.Z)("p",{},void 0,(0,a.Z)(k.Z,{id:"actualStatuses.quote_tombstone",defaultMessage:"Post is unavailable."}))):(0,a.Z)(G.Z,{statusId:x.quote})),(0,a.Z)("div",{className:"border-box"},void 0,l.createElement("div",{ref:v,className:"detailed-actualStatus",tabIndex:-1},(0,a.Z)("div",{className:"mb-4 flex items-center justify-between gap-1"},void 0,M?x.translations.get(p)?(0,a.Z)(I.xv,{theme:"subtle",className:"flex items-center",size:"xs"},void 0,(0,a.Z)(z.Z,{className:"mr-1",src:n(82)}),(0,a.Z)(k.Z,{id:"actualStatuses.translated",defaultMessage:"Translate"})):(0,a.Z)(I.zx,{theme:"link",size:"sm",onClick:w},void 0,(0,a.Z)(z.Z,{className:"mr-1",src:n(1265)}),(0,a.Z)(k.Z,{id:"actualStatuses.translate",defaultMessage:"Translate"})):(0,a.Z)(z.Z,{className:"text-gray-300 dark:text-slate-500",src:n(1266)}),(0,a.Z)(z.Z,{"aria-hidden":!0,src:N,className:"h-5 w-5 shrink-0 text-gray-400 dark:text-gray-600"})),(0,a.Z)("div",{className:"mb-3"},void 0,(0,a.Z)(A.Z,{id:_.id,timestamp:x.created_at,avatarSize:42,hideActions:!0},_.id)),(0,a.Z)(j.Z,{status:x}),(0,a.Z)(U.Z,{status:x,expanded:!x.hidden,onExpandedToggle:function(){i(s)}}),x.translations.get(p)&&!x.hidden&&l.createElement(l.Fragment,null,(0,a.Z)("hr",{className:"my-3"}),(0,a.Z)(I.xv,{className:"mb-1",size:"md",weight:"medium"},void 0,(0,a.Z)(k.Z,{id:"actualStatuses.translate_done",defaultMessage:"Status translated to {locale}",values:{locale:h}})),(0,a.Z)("div",{className:"status__content",lang:p,dangerouslySetInnerHTML:{__html:x.translations.get(p)}})),!x.hidden&&l.createElement(l.Fragment,null,(0,a.Z)(D.Z,{status:x,showMedia:c,onToggleVisibility:r}),t),(0,a.Z)(I.Ug,{justifyContent:"between",alignItems:"center",className:"py-2"},void 0,(0,a.Z)(L,{status:x}),(0,a.Z)(I.Kq,{space:1,className:"items-end mb-3"},void 0,(0,a.Z)("span",{},void 0,(0,a.Z)("a",{href:x.url,target:"_blank",rel:"noopener",className:"hover:underline"},void 0,(0,a.Z)(I.xv,{tag:"span",theme:"muted",size:"sm"},void 0,(0,a.Z)(d.Ji,{value:new Date(x.created_at),hour12:!1,year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"}))),x.edited_at&&l.createElement(l.Fragment,null," · ",(0,a.Z)("div",{className:"inline hover:underline",onClick:function(){o(s)},role:"button",tabIndex:0},void 0,(0,a.Z)(I.xv,{tag:"span",theme:"muted",size:"sm"},void 0,(0,a.Z)(k.Z,{id:"actualStatus.edited",defaultMessage:"Edited {date}",values:{date:m.formatDate(new Date(x.edited_at),{hour12:!1,month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}})))))))))):null},V=function(){var e=(0,T.CG)((function(e){return e.instance.title}));return(0,T.CG)((function(e){return e.instance.registrations}))?(0,a.Z)(I.Zb,{className:"px-6 py-12 space-y-6 text-center",variant:"rounded"},void 0,(0,a.Z)(I.Kq,{},void 0,(0,a.Z)(I.ll,{title:(0,a.Z)(k.Z,{id:"thread_login.title",defaultMessage:"Continue the conversation"})}),(0,a.Z)(I.xv,{},void 0,(0,a.Z)(k.Z,{id:"thread_login.message",defaultMessage:"Join {siteTitle} to get the full story and details.",values:{siteTitle:e}}))),(0,a.Z)(I.Kq,{space:4,className:"max-w-xs mx-auto"},void 0,(0,a.Z)(I.zx,{theme:"secondary",to:"/login",block:!0},void 0,(0,a.Z)(k.Z,{id:"thread_login.login",defaultMessage:"Log in"})),(0,a.Z)(I.zx,{to:"/signup",block:!0},void 0,(0,a.Z)(k.Z,{id:"thread_login.signup",defaultMessage:"Sign up"})))):null},F=n(157),P=function(e){var t,n,s=e.id,i=e.focusedStatusId,o=(0,T.CG)((function(e){return e.contexts.inReplyTos.get(s)})),c=(0,T.CG)((function(e){return e.contexts.replies.get(s,(0,u.OrderedSet)()).size})),d=(0,T.CG)((function(e){return Boolean(e.statuses.get(s))}));return(0,a.Z)("div",{className:"thread__status"},void 0,(n=c>0,(t=o&&o!==i)||n?(0,a.Z)("div",{className:r()("thread__connector",{"thread__connector--top":t,"thread__connector--bottom":n})}):null),d?l.createElement(F.Z,e):(0,a.Z)(C.Z,{}))},J=(0,d.vU)({title:{id:"status.title",defaultMessage:"@{username}'s Post"},titleDirect:{id:"status.title_direct",defaultMessage:"Direct message"},deleteConfirm:{id:"confirmations.delete.confirm",defaultMessage:"Delete"},deleteHeading:{id:"confirmations.delete.heading",defaultMessage:"Delete post"},deleteMessage:{id:"confirmations.delete.message",defaultMessage:"Are you sure you want to delete this post?"},redraftConfirm:{id:"confirmations.redraft.confirm",defaultMessage:"Delete & redraft"},redraftHeading:{id:"confirmations.redraft.heading",defaultMessage:"Delete & redraft"},redraftMessage:{id:"confirmations.redraft.message",defaultMessage:"Are you sure you want to delete this post and re-draft it? Favorites and reposts will be lost, and replies to the original post will be orphaned."},blockConfirm:{id:"confirmations.block.confirm",defaultMessage:"Block"},revealAll:{id:"status.show_more_all",defaultMessage:"Show more for all"},hideAll:{id:"status.show_less_all",defaultMessage:"Show less for all"},detailedStatus:{id:"status.detailed_status",defaultMessage:"Detailed conversation view"},replyConfirm:{id:"confirmations.reply.confirm",defaultMessage:"Reply"},replyMessage:{id:"confirmations.reply.message",defaultMessage:"Replying now will overwrite the message you are currently composing. Are you sure you want to proceed?"},blockAndReport:{id:"confirmations.block.block_and_report",defaultMessage:"Block & Report"}}),W=(0,O.TE)(),X=(0,v.P1)([function(e,t){return t},function(e){return e.contexts.inReplyTos}],(function(e,t){for(var n=(0,u.OrderedSet)(),a=e;a&&!n.includes(a);)n=(0,u.OrderedSet)([a]).union(n),a=t.get(a);return n})),Y=(0,v.P1)([function(e,t){return t},function(e){return e.contexts.replies}],(function(e,t){for(var n=(0,u.OrderedSet)(),a=[e];a.length>0;){var s=a.shift();if(!s)break;var i=t.get(s);if(n.includes(s))break;e!==s&&(n=n.union([s])),i&&i.reverse().forEach((function(e){a.unshift(e)}))}return n})),$=function(e){var t=(0,f.Z)(),n=(0,m.k6)(),s=(0,T.TL)(),o=(0,T.rV)(),d=(0,T.CG)((function(e){return e.me})),v=(0,T.CG)((function(t){return W(t,{id:e.params.statusId})})),k=o.get("displayMedia"),O=(0,T.CG)((function(e){var t=(0,u.OrderedSet)(),n=(0,u.OrderedSet)();if(v){var a=v.id;t=X(e,e.contexts.inReplyTos.get(a)),n=Y(e,a),t=t.delete(a).subtract(n),n=n.delete(a).subtract(t)}return{status:v,ancestorsIds:t,descendantsIds:n}})),z=O.ancestorsIds,D=O.descendantsIds,j=(0,l.useState)((0,R.qI)(v,k)),U=j[0],A=j[1],G=(0,l.useState)(!!v),q=G[0],H=G[1],K=(0,l.useState)(),L=K[0],F=K[1],$=(0,l.useRef)(null),Q=(0,l.useRef)(null),ee=(0,l.useRef)(null),te=function(){return t=void 0,n=void 0,i=function(){var t,n,a;return function(e,t){var n,a,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(s=2&i[0]?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}}(this,(function(i){switch(i.label){case 0:return t=e.params,n=t.statusId,[4,s((0,b.wE)(n))];case 1:return a=i.sent().next,F(a),[2]}}))},new((a=void 0)||(a=Promise))((function(e,s){function o(e){try{u(i.next(e))}catch(e){s(e)}}function r(e){try{u(i.throw(e))}catch(e){s(e)}}function u(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,r)}u((i=i.apply(t,n||[])).next())}));var t,n,a,i};(0,l.useEffect)((function(){te().then((function(){H(!0)})).catch((function(e){H(!0)}))}),[e.params.statusId]);var ne=function(){A(!U)},ae=function(e){s((0,p.UM)(e))},se=function(e){e.hidden?s((0,b.oK)(e.id)):s((0,b.E1)(e.id))},ie=l.useCallback((function(e,t){s((0,b.df)(e.id,t))}),[]),oe=function(e){if(e===(null==v?void 0:v.id))ue(z.size-1);else{var t=(0,u.List)(z).indexOf(e);-1===t?(t=(0,u.List)(D).indexOf(e),ue(z.size+t)):ue(t-1)}},re=function(e){if(e===(null==v?void 0:v.id))ue(z.size+1);else{var t=(0,u.List)(z).indexOf(e);-1===t?(t=(0,u.List)(D).indexOf(e),ue(z.size+t+2)):ue(t+1)}},ue=function(e){var t;null===(t=ee.current)||void 0===t||t.scrollIntoView({index:e,behavior:"smooth",done:function(){var t=document.querySelector('#thread [data-index="'.concat(e,'"] .focusable'));t&&t.focus()}})},le=function(e){return e.map((function(e){return e.endsWith("-tombstone")?function(e){return(0,a.Z)("div",{className:"py-4 pb-8"},void 0,(0,a.Z)(S,{id:e,onMoveUp:oe,onMoveDown:re},e))}(e):e.startsWith("末pending-")?function(e){var t=e.replace(/^末pending-/,"");return(0,a.Z)(E.Z,{className:"thread__status",idempotencyKey:t},e)}(e):function(e){return(0,a.Z)(P,{id:e,focusedStatusId:v.id,onMoveUp:oe,onMoveDown:re},e)}(e)}))};(0,l.useEffect)((function(){A((0,R.qI)(v,k))}),[null==v?void 0:v.id]),(0,l.useEffect)((function(){var e;null===(e=ee.current)||void 0===e||e.scrollToIndex({index:z.size,offset:-80}),setImmediate((function(){var e,t;return null===(e=Q.current)||void 0===e||null===(t=e.querySelector(".detailed-status"))||void 0===t?void 0:t.focus()}))}),[e.params.statusId,null==v?void 0:v.id,z.size,q]);var ce=(0,l.useCallback)(i()((function(){L&&v&&s((0,b.TA)(v.id,L)).then((function(e){var t=e.next;F(t)})).catch((function(){}))}),300,{leading:!0}),[L,v]),de=z.size>0,fe=D.size>0;if(!v&&q)return(0,a.Z)(y.Z,{});if(!v)return(0,a.Z)(C.Z,{});var me={moveUp:function(){oe(v.id)},moveDown:function(){re(v.id)},reply:function(e){null==e||e.preventDefault(),function(e){s((0,g.DK)(e,t))}(v)},favourite:function(){!function(e){e.favourited?s((0,p.m9)(e)):s((0,p.yF)(e))}(v)},boost:function(){!function(e,t){s((function(t,n){var a=(0,Z.Gw)(n()).get("boostModal");e.reblogged?s((0,p.y_)(e)):a?s((0,h.h7)("BOOST",{status:e,onReblog:ae})):ae(e)}))}(v)},mention:function(e){null==e||e.preventDefault();var t=v.account;t&&"object"==typeof t&&function(e){s((0,g.Ck)(e))}(t)},openProfile:function(){n.push("/@".concat(v.getIn(["account","acct"])))},toggleHidden:function(){se(v)},toggleSensitive:function(){ne()},openMedia:function(t){var n=e.onOpenMedia,a=e.onOpenVideo,s=null==v?void 0:v.media_attachments.get(0);null==t||t.preventDefault(),v&&s&&("video"===s.type?a(s,0):n(v.media_attachments,0))},react:function(){if(Q.current){var e=Q.current.querySelector(".emoji-react-selector .emoji-react-selector__emoji");null==e||e.focus()}}},ve=String(v.getIn(["account","acct"])),ge="direct"===v.visibility?J.titleDirect:J.title,pe=(0,a.Z)("div",{className:r()("thread__detailed-status",{"pb-4":fe})},v.id,(0,a.Z)(c.HotKeys,{handlers:me},void 0,l.createElement("div",{ref:Q,className:"detailed-status__wrapper focusable",tabIndex:0,"aria-label":(0,R.XA)(t,v)},(0,a.Z)(B,{status:v,onOpenVideo:function(e,t){s((0,h.h7)("VIDEO",{media:e,time:t}))},onOpenMedia:function(e,t){s((0,h.h7)("MEDIA",{media:e,index:t}))},onToggleHidden:se,showMedia:U,onToggleMediaVisibility:ne,onOpenCompareHistoryModal:function(e){s((0,h.h7)("COMPARE_HISTORY",{statusId:e.id}))},onTranslate:ie}),(0,a.Z)("hr",{className:"mb-3 dark:border-slate-600"}),(0,a.Z)(M.Z,{status:v}))),fe&&(0,a.Z)("hr",{className:"mt-2 dark:border-slate-600"})),he=[];return de&&he.push.apply(he,le(z).toArray()),he.push(pe),fe&&he.push.apply(he,le(D).toArray()),(0,a.Z)(I.sg,{label:t.formatMessage(ge,{username:ve}),transparent:!0,withHeader:!1},void 0,(0,a.Z)(w,{stickyClassName:"sm:hidden w-full shadow-lg before:-z-10 before:bg-gradient-sm before:w-full before:h-full before:absolute before:top-0 before:left-0  bg-white dark:bg-slate-900"},void 0,(0,a.Z)("div",{className:"px-4 pt-4 sm:p-0"},void 0,(0,a.Z)(N.Z,{message:t.formatMessage(ge,{username:ve})}))),(0,a.Z)(x.Z,{onRefresh:function(){return te()}},void 0,(0,a.Z)(I.Kq,{space:2},void 0,l.createElement("div",{ref:$,className:"thread"},l.createElement(_.Z,{id:"thread",ref:ee,hasMore:!!L,onLoadMore:ce,placeholderComponent:function(){return(0,a.Z)(C.Z,{})},initialTopMostItemIndex:z.size},he)),!d&&(0,a.Z)(V,{}))))}},1265:function(e,t,n){e.exports=n.p+"packs/icons/language-796e96c4.svg"},1266:function(e,t,n){e.exports=n.p+"packs/icons/note-7d075c16.svg"}}]);
//# sourceMappingURL=status-32cd87177e8a4e5e605d.chunk.js.map