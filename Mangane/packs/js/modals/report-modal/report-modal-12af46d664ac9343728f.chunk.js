"use strict";(self.webpackChunkmangane_fe=self.webpackChunkmangane_fe||[]).push([[209],{782:function(e,t,r){r.r(t),r.d(t,{default:function(){return q}});var n,a=r(1845),i=(r(2),r(0)),o=r(829),s=r(1834),d=r(1857),u=r(13),c=r(108),l=r(25),f=r(200),g=r(306),m=r(1),p=r(23),h=r(3),v=r(107),Z=(0,o.vU)({title:{id:"report.confirmation.title",defaultMessage:"Thanks for submitting your report."},content:{id:"report.confirmation.content",defaultMessage:"If we find that this account is violating the {link} we will take further action on the matter."}}),b=(0,a.Z)(d.Z,{id:"shared.tos",defaultMessage:"Terms of Service"}),k=r(244),w=r(6),x=r(169),M=r(277),y=(r(7),r(390)),C=r.n(y),E=r(310),_=r(35),T=function(e){var t,r,n,i=e.id,o=e.disabled,s=(0,h.TL)(),d=(0,h.CG)((function(e){return e.statuses.get(i)})),u=(0,h.CG)((function(e){return e.reports.new.status_ids.includes(i)}));if(!d||d.reblog)return null;if(d.media_attachments.size>0)if(d.media_attachments.some((function(e){return"unknown"===e.type})));else if("video"===(null===(r=d.media_attachments.get(0))||void 0===r?void 0:r.type)){var l=d.media_attachments.get(0);l&&(t=(0,a.Z)(E.Z,{fetchComponent:_.nk},void 0,(function(e){return(0,a.Z)(e,{preview:l.preview_url,blurhash:l.blurhash,src:l.url,alt:l.description,aspectRatio:l.meta.getIn(["original","aspect"]),width:239,height:110,inline:!0,sensitive:d.sensitive,onOpenVideo:C()})})))}else if("audio"===(null===(n=d.media_attachments.get(0))||void 0===n?void 0:n.type)){var f=d.media_attachments.get(0);f&&(t=(0,a.Z)(E.Z,{fetchComponent:_.Bb},void 0,(function(e){return(0,a.Z)(e,{src:f.url,alt:f.description,inline:!0,sensitive:d.sensitive,onOpenAudio:C()})})))}else t=(0,a.Z)(E.Z,{fetchComponent:_.ew},void 0,(function(e){return(0,a.Z)(e,{media:d.media_attachments,sensitive:d.sensitive,height:110,onOpenMedia:C()})}));return(0,a.Z)("div",{className:"status-check-box"},void 0,(0,a.Z)("div",{className:"status-check-box__status"},void 0,(0,a.Z)(g.Z,{status:d}),t),(0,a.Z)("div",{className:"status-check-box-toggle"},void 0,(0,a.Z)(x.Z,{checked:u,onChange:function(e){return s((0,c.cm)(i,e.target.checked))},disabled:o,icons:!1})))},A=r(46),N=(0,o.vU)({addAdditionalStatuses:{id:"report.otherActions.addAdditionl",defaultMessage:"Would you like to add additional statuses to this report?"},addMore:{id:"report.otherActions.addMore",defaultMessage:"Add more"},furtherActions:{id:"report.otherActions.furtherActions",defaultMessage:"Further actions:"},hideAdditonalStatuses:{id:"report.otherActions.hideAdditional",defaultMessage:"Hide additional statuses"},otherStatuses:{id:"report.otherActions.otherStatuses",defaultMessage:"Include other statuses?"}}),S=r(5),z=r.n(S),G=(0,o.vU)({placeholder:{id:"report.placeholder",defaultMessage:"Additional comments"},reasonForReporting:{id:"report.reason.title",defaultMessage:"Reason for reporting"}}),O=(0,o.vU)({blankslate:{id:"report.reason.blankslate",defaultMessage:"You have removed all statuses from being selected."},done:{id:"report.done",defaultMessage:"Done"},next:{id:"report.next",defaultMessage:"Next"},close:{id:"lightbox.close",defaultMessage:"Close"},placeholder:{id:"report.placeholder",defaultMessage:"Additional comments"},submit:{id:"report.submit",defaultMessage:"Submit"}});!function(e){e.ONE="ONE",e.TWO="TWO",e.THREE="THREE"}(n||(n={}));var R={ONE:function(e){var t=(0,w.I0)(),r=(0,s.Z)(),n=(0,i.useRef)(null),o=(0,i.useState)(!1),d=o[0],u=o[1],l=(0,i.useState)(!0),f=l[0],g=l[1],p=(0,h.CG)((function(e){return e.reports.new.comment})),v=(0,h.CG)((function(e){return e.rules.items})),Z=(0,h.CG)((function(e){return e.reports.new.rule_ids})),b=v.length>0,k=(0,h.CG)((function(e){return e.reports.new.status_ids})),x=(0,i.useMemo)((function(){return 0===k.size}),[]);return(0,i.useEffect)((function(){t((0,M.j)())}),[]),(0,i.useEffect)((function(){v.length>0&&n.current&&n.current.clientHeight<=385&&u(!0)}),[v,n.current]),(0,a.Z)(m.Kq,{space:4},void 0,b&&(0,a.Z)(m.Kq,{space:2},void 0,(0,a.Z)(m.xv,{size:"xl",weight:"semibold",tag:"h1"},void 0,r.formatMessage(G.reasonForReporting)),(0,a.Z)("div",{className:"relative"},void 0,i.createElement("div",{style:{maxHeight:385},className:"rounded-lg -space-y-px overflow-y-auto",onScroll:function(){if(n.current){var e=n.current,t=e.scrollTop,r=e.scrollHeight,a=e.clientHeight;u(t+a>r-24),g(t<24)}},ref:n},v.filter((function(e){var t=x?"account":"content";return!e.rule_type||e.rule_type===t})).map((function(e,r){var n=Z.includes(String(e.id));return(0,a.Z)("button",{"data-testid":"rule-".concat(e.id),onClick:function(){return t((0,c.Nr)(e.id))},className:z()({"relative border border-solid border-gray-200 dark:border-slate-900/75 hover:bg-gray-50 dark:hover:bg-slate-900/50 text-left w-full p-4 flex justify-between items-center cursor-pointer":!0,"rounded-tl-lg rounded-tr-lg":0===r,"rounded-bl-lg rounded-br-lg":r===v.length-1,"bg-gray-50 dark:bg-slate-900":n})},r,(0,a.Z)(m.Kq,{className:"mr-3"},void 0,(0,a.Z)(m.xv,{tag:"span",size:"sm",weight:"medium",theme:n?"primary":"default"},void 0,e.text),(0,a.Z)(m.xv,{tag:"span",theme:"muted",size:"sm"},void 0,e.subtext)),(0,a.Z)("input",{name:"reason",type:"checkbox",value:e.id,checked:n,readOnly:!0,className:"h-4 w-4 cursor-pointer text-primary-600 dark:text-primary-400 border-gray-300 rounded focus:ring-primary-500"}))}))),(0,a.Z)("div",{className:z()("inset-x-0 top-0 flex rounded-t-lg justify-center bg-gradient-to-b from-white pb-12 pt-8 pointer-events-none dark:from-slate-900 absolute transition-opacity duration-500",{"opacity-0":f,"opacity-100":!f})}),(0,a.Z)("div",{className:z()("inset-x-0 bottom-0 flex rounded-b-lg justify-center bg-gradient-to-t from-white pt-12 pb-8 pointer-events-none dark:from-slate-900 absolute transition-opacity duration-500",{"opacity-0":d,"opacity-100":!d})}))),(0,a.Z)(m.cw,{labelText:r.formatMessage(G.placeholder)},void 0,(0,a.Z)(m.gx,{placeholder:r.formatMessage(G.placeholder),value:p,onChange:function(e){t((0,c.Ck)(e.target.value))}})))},TWO:function(e){var t=e.account,n=(0,w.I0)(),o=(0,h.hz)(),u=(0,s.Z)(),l=(0,h.CG)((function(e){return(0,k.OrderedSet)(e.timelines.get("account:".concat(t.id,":with_replies")).items).union(e.reports.new.status_ids)})),f=(0,h.CG)((function(e){return e.reports.new.block})),g=(0,h.CG)((function(e){return e.reports.new.forward})),p=(0,A.Q1)(t)&&o.federating,v=(0,h.CG)((function(e){return e.reports.new.isSubmitting})),Z=(0,i.useState)(!1),b=Z[0],y=Z[1];return(0,i.useEffect)((function(){n((0,M.j)())}),[]),(0,a.Z)(m.Kq,{space:4},void 0,o.reportMultipleStatuses&&(0,a.Z)(m.Kq,{space:2},void 0,(0,a.Z)(m.xv,{tag:"h1",size:"xl",weight:"semibold"},void 0,u.formatMessage(N.otherStatuses)),(0,a.Z)(m.cw,{labelText:u.formatMessage(N.addAdditionalStatuses)},void 0,b?(0,a.Z)(m.Kq,{space:2},void 0,(0,a.Z)("div",{className:"bg-gray-100 dark:bg-slate-600 rounded-lg p-4"},void 0,l.map((function(e){return(0,a.Z)(T,{id:e},e)}))),(0,a.Z)("div",{},void 0,(0,a.Z)(m.zx,{icon:r(898),theme:"secondary",size:"sm",onClick:function(){return y(!1)}},void 0,u.formatMessage(N.hideAdditonalStatuses)))):(0,a.Z)(m.zx,{icon:r(50),theme:"secondary",size:"sm",onClick:function(){return y(!0)}},void 0,u.formatMessage(N.addMore)))),(0,a.Z)(m.Kq,{space:2},void 0,(0,a.Z)(m.xv,{tag:"h1",size:"xl",weight:"semibold"},void 0,u.formatMessage(N.furtherActions)),(0,a.Z)(m.cw,{labelText:(0,a.Z)(d.Z,{id:"report.block_hint",defaultMessage:"Do you also want to block this account?"})},void 0,(0,a.Z)(m.Ug,{space:2,alignItems:"center"},void 0,(0,a.Z)(x.Z,{checked:f,onChange:function(e){n((0,c.LG)(e.target.checked))},icons:!1,id:"report-block"}),(0,a.Z)(m.xv,{theme:"muted",tag:"label",size:"sm",htmlFor:"report-block"},void 0,(0,a.Z)(d.Z,{id:"report.block",defaultMessage:"Block {target}",values:{target:"@".concat(t.get("acct"))}})))),p&&(0,a.Z)(m.cw,{labelText:(0,a.Z)(d.Z,{id:"report.forward_hint",defaultMessage:"The account is from another server. Send a copy of the report there as well?"})},void 0,(0,a.Z)(m.Ug,{space:2,alignItems:"center"},void 0,(0,a.Z)(x.Z,{checked:g,onChange:function(e){n((0,c.$p)(e.target.checked))},icons:!1,id:"report-forward",disabled:v}),(0,a.Z)(m.xv,{theme:"muted",tag:"label",size:"sm",htmlFor:"report-forward"},void 0,(0,a.Z)(d.Z,{id:"report.forward",defaultMessage:"Forward to {target}",values:{target:(0,A.ge)(t)}}))))))},THREE:function(e){e.account;var t,r=(0,s.Z)(),n=(0,h.CG)((function(e){return(0,v.UX)(e).get("links")}));return(0,a.Z)(m.Kq,{space:1},void 0,(0,a.Z)(m.xv,{weight:"semibold",tag:"h1",size:"xl"},void 0,r.formatMessage(Z.title)),(0,a.Z)(m.xv,{},void 0,r.formatMessage(Z.content,{link:n.get("termsOfService")?(t=n.get("termsOfService"),(0,a.Z)("a",{href:t,target:"_blank",className:"hover:underline text-primary-600 dark:text-primary-400 hover:text-primary-800 dark:hover:text-primary-500"},void 0,b)):b})))}},H=function(e){var t=e.statusId,r=(0,h.CG)((function(e){return e.statuses.get(t)}));return r?(0,a.Z)(m.Kq,{space:2,className:"p-4 rounded-lg bg-gray-100 dark:bg-slate-700"},void 0,(0,a.Z)(p.Z,{id:r.account,showProfileHoverCard:!1,withLinkToProfile:!1,timestamp:r.created_at,hideActions:!0}),(0,a.Z)(g.Z,{status:r,expanded:!0,collapsable:!0}),r.media_attachments.size>0&&(0,a.Z)(f.Z,{media:r.media_attachments,sensitive:r.sensitive})):null},q=function(e){var t=e.onClose,r=(0,h.TL)(),o=(0,s.Z)(),f=(0,h.CG)((function(e){return e.reports.new.account_id})),g=(0,h.mA)(f),p=(0,h.CG)((function(e){return e.reports.new.block})),v=(0,h.CG)((function(e){return e.reports.new.isSubmitting})),Z=(0,h.CG)((function(e){return e.rules.items})),b=(0,h.CG)((function(e){return e.reports.new.rule_ids})),k=(0,h.CG)((function(e){return e.reports.new.status_ids})),w=(0,i.useMemo)((function(){return 0===k.size}),[]),x=Z.length>0,M=(0,i.useState)(n.ONE),y=M[0],C=M[1],E=(0,i.useCallback)((function(){return 0===k.size?(0,a.Z)("div",{className:"bg-gray-100 dark:bg-slate-700 p-4 rounded-lg flex items-center justify-center w-full"},void 0,(0,a.Z)(m.xv,{theme:"muted"},void 0,o.formatMessage(O.blankslate))):(0,a.Z)(H,{statusId:k.first()})}),[k.size]),_=(0,i.useMemo)((function(){switch(y){case n.TWO:return o.formatMessage(O.submit);case n.THREE:return o.formatMessage(O.done);default:return o.formatMessage(O.next)}}),[y]),T=(0,i.useMemo)((function(){return y!==n.THREE&&(v||x&&b.isEmpty()||!w&&0===k.size)}),[y,v,x,b,k.size,w]),A=(0,i.useCallback)((function(){switch(y){case n.ONE:return.33;case n.TWO:return.66;case n.THREE:return 1;default:return 0}}),[y]);if((0,i.useEffect)((function(){g&&r((0,l.Cn)(g.id,{withReplies:!0,maxId:null}))}),[g]),!g)return null;var N=R[y];return(0,a.Z)(m.u_,{title:(0,a.Z)(d.Z,{id:"report.target",defaultMessage:"Reporting {target}",values:{target:(0,a.Z)("strong",{},void 0,"@",g.acct)}}),onClose:t,cancelAction:y===n.THREE?void 0:t,confirmationAction:function(){switch(y){case n.ONE:C(n.TWO);break;case n.TWO:r((0,c.ZD)()).then((function(){return C(n.THREE)})).catch((function(e){return r((0,c.rC)(e))})),p&&g&&r((0,u.Gy_)(g.id));break;case n.THREE:r((0,c.rq)()),t()}},confirmationText:_,confirmationDisabled:T,skipFocus:!0},void 0,(0,a.Z)(m.Kq,{space:4},void 0,(0,a.Z)(m.ko,{progress:A()}),y!==n.THREE&&!w&&E(),(0,a.Z)(N,{account:g})))}}}]);
//# sourceMappingURL=report-modal-12af46d664ac9343728f.chunk.js.map